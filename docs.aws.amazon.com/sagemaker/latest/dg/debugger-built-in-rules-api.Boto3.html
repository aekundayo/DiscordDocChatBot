<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AWS Boto3 - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="debugger-built-in-rules-api.Boto3" /><meta name="default_state" content="debugger-built-in-rules-api.Boto3" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="debugger-built-in-rules-api.Boto3.html" /><meta name="description" content="Amazon SageMaker Debugger built-in rules can be configured for a training job using the create_training_job() function of the AWS Boto3 SageMaker client. You need to specify the right image URI in the RuleEvaluatorImage parameter, and the following examples walk you through how to set up the request body for the" /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="debugger-built-in-rules-api.Boto3.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" hreflang="de" /><link rel="alternative" href="debugger-built-in-rules-api.Boto3.html" hreflang="en-us" /><link rel="alternative" href="debugger-built-in-rules-api.Boto3.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" hreflang="zh-tw" /><link rel="alternative" href="debugger-built-in-rules-api.Boto3.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="AWS Boto3" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AWS Boto3 - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#debugger-built-in-rules-api.Boto3" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Train machine learning models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/train-model.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Debug and improve model performance",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/train-debug-and-improve-model-performance.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Use Amazon SageMaker Debugger to debug and improve model performance",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/train-debugger.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Configure Debugger Using Amazon SageMaker API",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/debugger-createtrainingjob-api.html"
      },
      {
        "@type" : "ListItem",
        "position" : 8,
        "name" : "AWS Boto3",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/debugger-createtrainingjob-api.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#debugger-built-in-rules-api.Boto3" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="page-toc-src"><a href="debugger-built-in-rules-api.Boto3.html#debugger-built-in-rules-api-debug.Boto3">To configure a Debugger rule for
                    debugging model parameters</a><a href="debugger-built-in-rules-api.Boto3.html#debugger-built-in-rules-api-profile.Boto3">To configure a Debugger built-in
                    rule for profiling system and framework metrics</a><a href="debugger-built-in-rules-api.Boto3.html#debugger-updatetrainingjob-api.Boto3">Update Debugger Profiling Configuration Using
                    the UpdateTrainingJob API Operation</a><a href="debugger-built-in-rules-api.Boto3.html#debugger-custom-rules-api.Boto3">Add Debugger Custom Rule Configuration to the
                    CreateTrainingJob API Operation</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="debugger-built-in-rules-api.Boto3">AWS Boto3</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Amazon SageMaker Debugger built-in rules can be configured for a training job using the <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sagemaker.html#SageMaker.Client.create_training_job" rel="noopener noreferrer" target="_blank"><span><code class="code">create_training_job()</code></span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> function of the AWS Boto3 SageMaker
            client. You need to specify the right image URI in the <code class="code">RuleEvaluatorImage</code>
            parameter, and the following examples walk you through how to set up the request body
            for the <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sagemaker.html#SageMaker.Client.create_training_job" rel="noopener noreferrer" target="_blank"><span><code class="code">create_training_job()</code></span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> function.</p><p>The following code shows a complete example of how to configure Debugger for the
                <code class="code">create_training_job()</code> request body and start a training job in
                <code class="code">us-west-2</code>, assuming that a training script
                <code class="code">entry_point/train.py</code> is prepared using TensorFlow. To find an
            end-to-end example notebook, see <a href="https://sagemaker-examples.readthedocs.io/en/latest/sagemaker-debugger/tensorflow_profiling/tf-resnet-profiling-multi-gpu-multi-node-boto3.html" rel="noopener noreferrer" target="_blank"><span>Profiling TensorFlow Multi GPU Multi Node Training Job with Amazon SageMaker
                Debugger (Boto3)</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Ensure that you use the correct Docker container images. To find available AWS Deep Learning
            Container images, see <a href="https://github.com/aws/deep-learning-containers/blob/master/available_images.md" rel="noopener noreferrer" target="_blank"><span>Available Deep Learning Containers Images</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. To find a complete list of available Docker images for using
                the Debugger rules, see <a href="debugger-docker-images-rules.html">Use Debugger Docker Images for Built-in or Custom
            Rules</a>.</p></div></div><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="py ">import sagemaker, boto3
import datetime, tarfile

# Start setting up a SageMaker session and a Boto3 SageMaker client
session = sagemaker.Session()
region = session.boto_region_name
bucket = session.default_bucket()

# Upload a training script to a default Amazon S3 bucket of the current SageMaker session
source = 'source.tar.gz'
project = '<code class="replaceable">debugger-boto3-test</code>'

tar = tarfile.open(source, 'w:gz')
tar.add ('<code class="replaceable">entry_point/train.py</code>') # Specify the directory and name of your training script
tar.close()

s3 = boto3.client('s3')
s3.upload_file(source, bucket, project+'/'+source)

# Set up a Boto3 session client for SageMaker
sm = boto3.Session(region_name=region).client("sagemaker")

# Start a training job
sm.create_training_job(
    TrainingJobName='debugger-boto3-'+datetime.datetime.now().strftime('%Y-%m-%d-%H-%M-%S'),
    HyperParameters=<span>{</span>
        'sagemaker_submit_directory': 's3://'+bucket+'/'+project+'/'+source,
        'sagemaker_program': '<code class="replaceable">/entry_point/train.py</code>' # training scrip file location and name under the sagemaker_submit_directory
    },
    AlgorithmSpecification=<span>{</span>
        # Specify a training Docker container image URI (Deep Learning Container or your own training container) to TrainingImage.
        'TrainingImage': '<code class="replaceable">763104351884.dkr.ecr.us-west-2.amazonaws.com/tensorflow-training:2.4.1-gpu-py37-cu110-ubuntu18.04</code>',
        'TrainingInputMode': '<code class="replaceable">File</code>',
        'EnableSageMakerMetricsTimeSeries': <code class="replaceable">False</code>
    },
    RoleArn='arn:aws:iam::111122223333:role/service-role/AmazonSageMaker-ExecutionRole-20201014T161125',
    OutputDataConfig=<span>{</span>'S3OutputPath': 's3://'+bucket+'/'+project+'/output'},
    ResourceConfig=<span>{</span>
        'InstanceType': '<code class="replaceable">ml.p3.8xlarge</code>',
        'InstanceCount': <code class="replaceable">1</code>,
        'VolumeSizeInGB': 30
    },
    StoppingCondition=<span>{</span>
        'MaxRuntimeInSeconds': 86400
    },
    DebugHookConfig=<span>{</span>
        'S3OutputPath': 's3://'+bucket+'/'+project+'/debug-output',
        'CollectionConfigurations': [
            <span>{</span>
                'CollectionName': '<code class="replaceable">losses</code>',
                'CollectionParameters' : <span>{</span>
                    'train.save_interval': '<code class="replaceable">500</code>',
                    'eval.save_interval': '<code class="replaceable">50</code>'
                }
            }
        ]
    },
    DebugRuleConfigurations=[
        <span>{</span>
            'RuleConfigurationName': '<code class="replaceable">LossNotDecreasing</code>',
            'RuleEvaluatorImage': '<code class="replaceable">895741380848.dkr.ecr.us-west-2.amazonaws.com/sagemaker-debugger-rules:latest</code>',
            'RuleParameters': <span>{</span>'rule_to_invoke': '<code class="replaceable">LossNotDecreasing</code>'}
        }
    ],
    ProfilerConfig=<span>{</span>
        'S3OutputPath': 's3://'+bucket+'/'+project+'/profiler-output',
        'ProfilingIntervalInMilliseconds': 500,
        'ProfilingParameters': <span>{</span>
            'DataloaderProfilingConfig': '<span>{</span>"StartStep": 5, "NumSteps": 3, "MetricsRegex": ".*", }',
            'DetailedProfilingConfig': '<span>{</span>"StartStep": 5, "NumSteps": 3, }',
            'PythonProfilingConfig': '<span>{</span>"StartStep": 5, "NumSteps": 3, "ProfilerName": "cprofile", "cProfileTimer": "total_time"}',
            'LocalPath': '/opt/ml/output/profiler/' # Optional. Local path for profiling outputs
        }
    },
    ProfilerRuleConfigurations=[
        <span>{</span>
            'RuleConfigurationName': 'ProfilerReport',
            'RuleEvaluatorImage': '<code class="replaceable">895741380848.dkr.ecr.us-west-2.amazonaws.com/sagemaker-debugger-rules:latest</code>',
            'RuleParameters': <span>{</span>'rule_to_invoke': 'ProfilerReport'}
        }
    ]
)</code></pre>
            <h2 id="debugger-built-in-rules-api-debug.Boto3">To configure a Debugger rule for
                    debugging model parameters</h2>
            <p>The following code samples show how to configure a built-in
                    <code class="code">VanishingGradient</code> rule using this SageMaker API. </p>
            <p><b>To enable Debugger to collect output tensors</b></p>
            <p>Specify the Debugger hook configuration as follows:</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="py ">DebugHookConfig=<span>{</span>
    'S3OutputPath': '<code class="replaceable">s3://&lt;default-bucket&gt;/&lt;training-job-name&gt;/debug-output</code>',
    'CollectionConfigurations': [
        <span>{</span>
            'CollectionName': '<code class="replaceable">gradients</code>',
            'CollectionParameters' : <span>{</span>
                'train.save_interval': '<code class="replaceable">500</code>',
                'eval.save_interval': '<code class="replaceable">50</code>'
            }
        }
    ]
}</code></pre>
            <p>This will make the training job save a tensor collection, <code class="code">gradients</code>,
                every <code class="code">save_interval</code> of 500 steps. To find available
                    <code class="code">CollectionName</code> values, see <a href="https://github.com/awslabs/sagemaker-debugger/blob/master/docs/api.md#built-in-collections" rel="noopener noreferrer" target="_blank"><span>Debugger Built-in Collections</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> in the <em>SMDebug client library
                    documentation</em>. To find available <code class="code">CollectionParameters</code>
                parameter keys and values, see the <a href="https://sagemaker.readthedocs.io/en/stable/api/training/debugger.html#sagemaker.debugger.CollectionConfig" rel="noopener noreferrer" target="_blank"><span><code class="code">sagemaker.debugger.CollectionConfig</code></span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> class in the
                    <em>SageMaker Python SDK documentation</em>.</p>
            <p><b>To enable Debugger rules for debugging the output
                tensors</b></p>
            <p>The following <code class="code">DebugRuleConfigurations</code> API example shows how to run
                the built-in <code class="code">VanishingGradient</code> rule on the saved <code class="code">gradients</code>
                collection.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="py ">DebugRuleConfigurations=[
    <span>{</span>
        'RuleConfigurationName': '<code class="replaceable">VanishingGradient</code>',
        'RuleEvaluatorImage': '<code class="replaceable">895741380848.dkr.ecr.us-west-2.amazonaws.com/sagemaker-debugger-rules:latest</code>',
        'RuleParameters': <span>{</span>
            'rule_to_invoke': '<code class="replaceable">VanishingGradient</code>',
            'threshold': '<code class="replaceable">20.0</code>'
        }
    }
]</code></pre>
            <p>With a configuration like the one in this sample, Debugger starts a rule evaluation
                job for your training job using the <code class="code">VanishingGradient</code> rule on the
                collection of <code class="code">gradients</code> tensor. To find a complete list of available
                Docker images for using the Debugger rules, see <a href="debugger-docker-images-rules.html">Use Debugger Docker Images for Built-in or Custom
            Rules</a>. To find the key-value pairs for
                    <code class="code">RuleParameters</code>, see <a href="debugger-built-in-rules.html">List of Debugger Built-in Rules</a>.</p>
         
            <h2 id="debugger-built-in-rules-api-profile.Boto3">To configure a Debugger built-in
                    rule for profiling system and framework metrics</h2>
            <p>The following example code shows how to specify the ProfilerConfig API operation to
                enable collecting system and framework metrics.</p>
            
            <p><b>To enable Debugger profiling to collect system and framework
                metrics</b></p>
            <awsdocs-tabs><dl style="display: none">
                <dt>Target Step</dt><dd tab-id="target-step"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="py ">ProfilerConfig=<span>{</span> 
    'S3OutputPath': '<code class="replaceable">s3://&lt;default-bucket&gt;/&lt;training-job-name&gt;/profiler-output</code>', # Optional. Path to an S3 bucket to save profiling outputs
    # Available values for ProfilingIntervalInMilliseconds: 100, 200, 500, 1000 (1 second), 5000 (5 seconds), and 60000 (1 minute) milliseconds.
    'ProfilingIntervalInMilliseconds': <code class="replaceable">500</code>, 
    'ProfilingParameters': <span>{</span>
        'DataloaderProfilingConfig': '<span>{</span>
            "StartStep": <code class="replaceable">5</code>, 
            "NumSteps": <code class="replaceable">3</code>, 
            "MetricsRegex": ".*"
        }',
        'DetailedProfilingConfig': '<span>{</span>
            "StartStep": <code class="replaceable">5</code>, 
            "NumSteps": <code class="replaceable">3</code> 
        }',
        'PythonProfilingConfig': '<span>{</span>
            "StartStep": <code class="replaceable">5</code>, 
            "NumSteps": <code class="replaceable">3</code>, 
            "ProfilerName": "<code class="replaceable">cprofile</code>",  # Available options: cprofile, pyinstrument
            "cProfileTimer": "<code class="replaceable">total_time</code>"  # Include only when using cprofile. Available options: cpu, off_cpu, total_time
        }',
        'LocalPath': '/opt/ml/output/profiler/' # Optional. Local path for profiling outputs
    }
}</code></pre>
                        </dd>
                    <dt>Target Time Duration</dt><dd tab-id="target-time-duration"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="py ">ProfilerConfig=<span>{</span> 
    'S3OutputPath': '<code class="replaceable">s3://&lt;default-bucket&gt;/&lt;training-job-name&gt;/profiler-output</code>', # Optional. Path to an S3 bucket to save profiling outputs
    # Available values for ProfilingIntervalInMilliseconds: 100, 200, 500, 1000 (1 second), 5000 (5 seconds), and 60000 (1 minute) milliseconds.
    'ProfilingIntervalInMilliseconds': <code class="replaceable">500</code>,
    'ProfilingParameters': <span>{</span>
        'DataloaderProfilingConfig': '<span>{</span>
            "StartTimeInSecSinceEpoch": <code class="replaceable">12345567789</code>, 
            "DurationInSeconds": <code class="replaceable">10</code>, 
            "MetricsRegex": ".*"
        }',
        'DetailedProfilingConfig': '<span>{</span>
            "StartTimeInSecSinceEpoch": <code class="replaceable">12345567789</code>, 
            "DurationInSeconds": <code class="replaceable">10</code>
        }',
        'PythonProfilingConfig': '<span>{</span>
            "StartTimeInSecSinceEpoch": <code class="replaceable">12345567789</code>, 
            "DurationInSeconds": <code class="replaceable">10</code>, 
            "ProfilerName": "<code class="replaceable">cprofile</code>",  # Available options: cprofile, pyinstrument
            "cProfileTimer": "<code class="replaceable">total_time</code>"  # Include only when using cprofile. Available options: cpu, off_cpu, total_time
        }',
        'LocalPath': '/opt/ml/output/profiler/' # Optional. Local path for profiling outputs
    }
}</code></pre>
                        </dd>
                </dl></awsdocs-tabs>
                <p><b>To enable Debugger rules for profiling the metrics</b></p>
                
                <p>The following example code shows how to configure the <code class="code">ProfilerReport</code> rule.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="py ">ProfilerRuleConfigurations=[ 
    <span>{</span>
        'RuleConfigurationName': 'ProfilerReport',
        'RuleEvaluatorImage': '<code class="replaceable">895741380848.dkr.ecr.us-west-2.amazonaws.com/sagemaker-debugger-rules:latest</code>',
        'RuleParameters': <span>{</span>
            'rule_to_invoke': 'ProfilerReport',
            'CPUBottleneck_cpu_threshold': '<code class="replaceable">90</code>',
            'IOBottleneck_threshold': '<code class="replaceable">90</code>'
        }
    }
]</code></pre>
            <p>To find a complete list of available Docker images for using the Debugger rules, see
                    <a href="debugger-docker-images-rules.html">Use Debugger Docker Images for Built-in or Custom
            Rules</a>. To find the key-value pairs for
                    <code class="code">RuleParameters</code>, see <a href="debugger-built-in-rules.html">List of Debugger Built-in Rules</a>.</p>
         
            <h2 id="debugger-updatetrainingjob-api.Boto3">Update Debugger Profiling Configuration Using
                    the <code class="code">UpdateTrainingJob</code> API Operation</h2>
            <p>Debugger profiling configuration can be updated while your training job is running
                by using the <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sagemaker.html#SageMaker.Client.update_training_job" rel="noopener noreferrer" target="_blank"><span><code class="code">update_training_job()</code></span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> function of the AWS Boto3 SageMaker
                client. Configure new <a href="https://docs.aws.amazon.com/sagemaker/latest/APIReference/API_ProfilerConfig.html">ProfilerConfig</a> and <a href="https://docs.aws.amazon.com/sagemaker/latest/APIReference/API_ProfilerRuleConfiguration.html">ProfilerRuleConfiguration</a> objects, and specify the training job name to
                the <code class="code">TrainingJobName</code> parameter.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="py ">ProfilerConfig=<span>{</span> 
    'DisableProfiler': <code class="replaceable">boolean</code>,
    'ProfilingIntervalInMilliseconds': <code class="replaceable">number</code>,
    'ProfilingParameters': <span>{</span> 
        '<code class="replaceable">string</code>' : '<code class="replaceable">string</code>' 
    }
},
ProfilerRuleConfigurations=[ 
    <span>{</span> 
        'RuleConfigurationName': '<code class="replaceable">string</code>',
        'RuleEvaluatorImage': '<code class="replaceable">string</code>',
        'RuleParameters': <span>{</span> 
            'string' : '<code class="replaceable">string</code>' 
        }
    }
],
TrainingJobName='<code class="replaceable">your-training-job-name-YYYY-MM-DD-HH-MM-SS-SSS</code>'</code></pre>
         
            <h2 id="debugger-custom-rules-api.Boto3">Add Debugger Custom Rule Configuration to the
                    CreateTrainingJob API Operation</h2>
            <p>A custom rule can be configured for a training job using the <a href="https://docs.aws.amazon.com/sagemaker/latest/APIReference/API_DebugHookConfig.html">
                    DebugHookConfig</a> and <a href="https://docs.aws.amazon.com/sagemaker/latest/APIReference/API_DebugRuleConfiguration.html">
                    DebugRuleConfiguration</a> objects using the AWS Boto3 SageMaker client's
                    <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sagemaker.html#SageMaker.Client.create_training_job" rel="noopener noreferrer" target="_blank"><span><code class="code">create_training_job()</code></span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> function. The following code
                sample shows how to configure a custom <code class="code">ImproperActivation</code> rule written
                with the <em>smdebug</em> library using this SageMaker API
                operation. This example assumes that youâ€™ve written the custom rule in <em>custom_rules.py</em> file and uploaded it to an Amazon S3 bucket.
                The example provides pre-built Docker images that you can use to run your custom
                rules. These are listed at <a href="debugger-docker-images-rules.html#debuger-custom-rule-registry-ids">Amazon SageMaker Debugger Registry URLs for Custom
                Rule Evaluators</a>. You specify the URL registry
                address for the pre-built Docker image in the <code class="code">RuleEvaluatorImage</code>
                parameter.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="py ">DebugHookConfig=<span>{</span>
    'S3OutputPath': '<code class="replaceable">s3://&lt;default-bucket&gt;/&lt;training-job-name&gt;/debug-output</code>',
    'CollectionConfigurations': [
        <span>{</span>
            'CollectionName': '<code class="replaceable">relu_activations</code>',
            'CollectionParameters': <span>{</span>
                'include_regex': '<code class="replaceable">relu</code>',
                'save_interval': '<code class="replaceable">500</code>',
                'end_step': '<code class="replaceable">5000</code>'
            }
        }
    ]
},
DebugRulesConfigurations=[
    <span>{</span>
        'RuleConfigurationName': '<code class="replaceable">improper_activation_job</code>',
        'RuleEvaluatorImage': '<code class="replaceable">552407032007.dkr.ecr.ap-south-1.amazonaws.com/sagemaker-debugger-rule-evaluator:latest</code>',
        'InstanceType': '<code class="replaceable">ml.c4.xlarge</code>',
        'VolumeSizeInGB': <code class="replaceable">400</code>,
        'RuleParameters': <span>{</span>
           'source_s3_uri': '<code class="replaceable">s3://bucket/custom_rules.py</code>',
           'rule_to_invoke': '<code class="replaceable">ImproperActivation</code>',
           'collection_names': '<code class="replaceable">relu_activations</code>'
        }
    }
]</code></pre>
            <p>To find a complete list of available Docker images for using the Debugger rules, see
                    <a href="debugger-docker-images-rules.html">Use Debugger Docker Images for Built-in or Custom
            Rules</a>. To find the key-value pairs for
                    <code class="code">RuleParameters</code>, see <a href="debugger-built-in-rules.html">List of Debugger Built-in Rules</a>.</p>
        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./debugger-built-in-rules-api.CLI.html">JSON (AWS CLI)</div><div id="next" class="next-link" accesskey="n" href="./debugger-best-practices.html">Best Practices for Debugger</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/debugger-built-in-rules-api.Boto3.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>