<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Train Using SageMaker Managed Warm Pools - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="train-warm-pools" /><meta name="default_state" content="train-warm-pools" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="train-warm-pools.html" /><meta name="description" content="Reduce startup latency by retaining infrastructure for consecutive training jobs with SageMaker managed warm pools." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="train-warm-pools.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/train-warm-pools.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/train-warm-pools.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/train-warm-pools.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/train-warm-pools.html" hreflang="de" /><link rel="alternative" href="train-warm-pools.html" hreflang="en-us" /><link rel="alternative" href="train-warm-pools.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/train-warm-pools.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/train-warm-pools.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/train-warm-pools.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/train-warm-pools.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/train-warm-pools.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/train-warm-pools.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/train-warm-pools.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/train-warm-pools.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/train-warm-pools.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/train-warm-pools.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/train-warm-pools.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/train-warm-pools.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/train-warm-pools.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/train-warm-pools.html" hreflang="zh-tw" /><link rel="alternative" href="train-warm-pools.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Train Using SageMaker Managed Warm Pools" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Train Using SageMaker Managed Warm Pools - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#train-warm-pools" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/train-warm-pools.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/train-warm-pools.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/train-warm-pools.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Train machine learning models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/train-model.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Train Using SageMaker Managed Warm Pools",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/train-model.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#train-warm-pools" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="page-toc-src"><a href="train-warm-pools.html#train-warm-pools-how-it-works">How it works</a><a href="train-warm-pools.html#train-warm-pools-resource-limits">Warm pool resource limits</a><a href="train-warm-pools.html#train-warm-pools-how-to-use">How to use SageMaker managed warm pools</a><a href="train-warm-pools.html#train-warm-pools-considerations">Considerations</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="train-warm-pools">Train Using SageMaker Managed Warm Pools</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>SageMaker managed warm pools let you retain and reuse provisioned infrastructure after the
        completion of a training job to reduce latency for repetitive workloads, such as iterative
        experimentation or running many jobs consecutively. Subsequent training jobs that match
        specified parameters run on the retained warm pool infrastructure, which speeds up start
        times by reducing the time spent provisioning resources. </p><div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>SageMaker managed warm pools are a billable resource. For more information, see <a href="train-warm-pools.html#train-warm-pools-billing">Billing</a>.</p></div></div><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="train-warm-pools.html#train-warm-pools-how-it-works">How it works</a></li><li><a href="train-warm-pools.html#train-warm-pools-resource-limits">Warm pool resource limits</a></li><li><a href="train-warm-pools.html#train-warm-pools-how-to-use">How to use SageMaker managed warm pools</a></li><li><a href="train-warm-pools.html#train-warm-pools-considerations">Considerations</a></li></ul></div>
        <h2 id="train-warm-pools-how-it-works">How it works</h2>
        <p>To use SageMaker managed warm pools and reduce latency between similar consecutive training
            jobs, create a training job that specifies a <code class="code">KeepAlivePeriodInSeconds</code> value
            in its <code class="code">ResourceConfig</code>. This value represents the duration of time in
            seconds to retain configured resources in a warm pool for subsequent training jobs. If
            you need to run several training jobs using similar configurations, you can further
            reduce latency and billable time by using a dedicated persistent cache directory to
            store and re-use your information in a different job.</p>
        <div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="train-warm-pools.html#train-warm-pools-lifecycle">Warm pool lifecycle</a></li><li><a href="train-warm-pools.html#train-warm-pools-creation">Warm pool creation</a></li><li><a href="train-warm-pools.html#train-warm-pools-matching-criteria">Matching training jobs</a></li><li><a href="train-warm-pools.html#train-warm-pools-maximum-duration">Maximum warm pool
                    duration</a></li><li><a href="train-warm-pools.html#train-warm-pools-persistent-cache">Using persistent cache</a></li><li><a href="train-warm-pools.html#train-warm-pools-billing">Billing</a></li></ul></div>
         
            <h3 id="train-warm-pools-lifecycle">Warm pool lifecycle</h3>
            <div class="orderedlist">
                 
                 
                 
                 
                 
                 
            <ol><li>
                    <p>Create an initial training job with a
                            <code class="code">KeepAlivePeriodInSeconds</code> value greater than 0. When you run
                        this first training job, this “cold-starts” a cluster with typical startup
                        times. </p>
                </li><li>
                    <p>When the first training job completes, the provisioned resources are kept
                        alive in a warm pool for the period specified in the
                            <code class="code">KeepAlivePeriodInSeconds</code> value. As long as the cluster is
                        healthy and the warm pool is within the specified
                            <code class="code">KeepAlivePeriodInSeconds</code>, then the warm pool status is
                            <code class="code">Available</code>. </p>
                </li><li>
                    <p>The warm pool stays <code class="code">Available</code> until it either identifies a
                        matching training job for reuse or it exceeds the specified
                            <code class="code">KeepAlivePeriodInSeconds</code> and is terminated. The maximum
                        length of time allowed for the <code class="code">KeepAlivePeriodInSeconds</code> is 3600
                        seconds (60 minutes). If the warm pool status is <code class="code">Terminated</code>,
                        then this is the end of the warm pool lifecycle.</p>
                </li><li>
                    <p>If the warm pool identifies a second training job with matching
                        specifications such as instance count or instance type, then the warm pool
                        moves from the first training job to the second training job for reuse. The
                        status of the first training job warm pool becomes <code class="code">Reused</code>. This
                        is the end of the warm pool lifecycle for the first training job. </p>
                </li><li>
                    <p>The status of the second training job that reused the warm pool becomes
                            <code class="code">InUse</code>. After the second training job completes, the warm
                        pool is <code class="code">Available</code> for the <code class="code">KeepAlivePeriodInSeconds</code>
                        duration specified in the second training job. A warm pool can continue
                        moving to subsequent matching training jobs for a maximum of 28 days.</p>
                </li><li>
                    <p>If the warm pool is no longer available to reuse, the warm pool status is
                            <code class="code">Terminated</code>. Warm pools are no longer available if they are
                        terminated by a user, for a patch update, or for exceeding the specified
                            <code class="code">KeepAlivePeriodInSeconds</code>.</p>
                </li></ol></div>
            <p>For more information on warm pool status options, see <a href="https://docs.aws.amazon.com/sagemaker/latest/APIReference/API_WarmPoolStatus.html">WarmPoolStatus</a> in the <em>Amazon SageMaker API
                    Reference</em>.</p>
         
         
            <h3 id="train-warm-pools-creation">Warm pool creation</h3>
            <p>If an initial training job successfully completes and has a
                    <code class="code">KeepAlivePeriodInSeconds</code> value greater than 0, this creates a warm
                pool. If you stop a training job after a cluster is already launched, a warm pool is
                still retained. If the training job fails due to an algorithm or client error, a
                warm pool is still retained. If the training job fails for any other reason that
                might compromise the health of the cluster, then the warm pool is not created. </p>
            <p>To verify successful warm pool creation, check the warm pool status of your
                training job. If a warm pool successfully provisions, the warm pool status is
                    <code class="code">Available</code>. If a warm pool fails to provision, the warm pool status
                is <code class="code">Terminated</code>.</p>
         
         
            <h3 id="train-warm-pools-matching-criteria">Matching training jobs</h3>
            <p>For a warm pool to persist, it must find a matching training job within the time
                specified in the <code class="code">KeepAlivePeriodInSeconds</code> value. The next training job
                is a match if the following values are identical: </p>
            <div class="itemizedlist">
                 
                 
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p><code class="code">RoleArn</code>
                    </p>
                </li><li class="listitem">
                    <p><code class="code">ResourceConfig</code> values:</p>
                    <div class="itemizedlist">
                         
                         
                         
                         
                    <ul class="itemizedlist"><li class="listitem">
                            <p><code class="code">InstanceCount</code></p>
                        </li><li class="listitem">
                            <p><code class="code">InstanceType</code></p>
                        </li><li class="listitem">
                            <p><code class="code">VolumeKmsKeyId</code></p>
                        </li><li class="listitem">
                            <p><code class="code">VolumeSizeInGB</code></p>
                        </li></ul></div>
                </li><li class="listitem">
                    <p><code class="code">VpcConfig</code> values:</p>
                    <div class="itemizedlist">
                         
                         
                    <ul class="itemizedlist"><li class="listitem">
                            <p><code class="code">SecurityGroupIds</code></p>
                        </li><li class="listitem">
                            <p><code class="code">Subnets</code></p>
                        </li></ul></div>
                </li><li class="listitem">
                    <p><code class="code">EnableInterContainerTrafficEncryption</code></p>
                </li><li class="listitem">
                    <p><code class="code">EnableNetworkIsolation</code></p>
                </li></ul></div>
            <p>All of these values must be the same for a warm pool to move to a subsequent
                training job for reuse.</p>
         
         
            <h3 id="train-warm-pools-maximum-duration">Maximum warm pool
                    duration</h3>
            <p>The maximum <code class="code">KeepAlivePeriodInSeconds</code> for a single training job is
                3600 seconds (60 minutes) and the maximum length of time that a warm pool cluster
                can continue running consecutive training jobs is 28 days. </p>
            <p>Each subsequent training job must also specify a
                    <code class="code">KeepAlivePeriodInSeconds</code> value. When the warm pool moves to the
                next training job, it inherits the new <code class="code">KeepAlivePeriodInSeconds</code> value
                specified in that training job’s <code class="code">ResourceConfig</code>. In this way, you can
                keep a warm pool moving from training job to training job for a maximum of 28
                days.</p>
            <p>If no <code class="code">KeepAlivePeriodInSeconds</code> is specified, then the warm pool spins
                down after the training job completes.</p>
         
         
            <h3 id="train-warm-pools-persistent-cache">Using persistent cache</h3>
            <p>When you create a warm pool, SageMaker mounts a special directory on the volume that
                will persist throughout the lifecycle of the warm pool. This directory can also be
                used to store information that you want to re-use in another job. </p>
            <p>Using persistent cache can reduce latency and billable time over using warm pools
                alone for jobs that require the following:</p>
            <div class="itemizedlist">
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>multiple interactions with similar configurations</p>
                </li><li class="listitem">
                    <p>incremental training jobs</p>
                </li><li class="listitem">
                    <p>hyperparameter optimization</p>
                </li></ul></div>
            <p>For example, you can avoid downloading the same Python dependencies on repeated
                runs by setting up a pip cache directory inside the persistent cache directory. You
                are fully responsible for managing the contents of this directory. The following are
                examples of types of information that you can put in your persistent cache to help
                reduce your latency and billable time.</p>
            <div class="itemizedlist">
                 
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>Dependencies managed by pip.</p>
                </li><li class="listitem">
                    <p>Dependencies managed by conda.</p>
                </li><li class="listitem">
                    <p><a href="model-checkpoints.html">Checkpoint
                            information</a>.</p>
                </li><li class="listitem">
                    <p>Any additional information generated during training.</p>
                </li></ul></div>
            <p>The location of the persistent cache is
                    <code class="code">/opt/ml/sagemaker/warmpoolcache</code>. The environment variable
                    <code class="code">SAGEMAKER_MANAGED_WARMPOOL_CACHE_DIRECTORY</code> points to the location
                of the persistent cache directory.</p>
            <p>The following code example shows you how to set up a warm pool and use persistent
                cache to store your pip dependencies for use in a subsequent job. The subsequent job
                must run within the time frame given by the parameter
                    <code class="code">keep_alive_period_in_seconds</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">import sagemakerfrom sagemaker import get_execution_rolefrom sagemaker.tensorflow import TensorFlow
# Creates a SageMaker session and gets execution role
session = sagemaker.Session()
role = get_execution_role()
# Creates an example estimator
estimator = TensorFlow(
    ...
    entry_point='<code class="replaceable">my-training-script.py</code>',
    source_dir='<code class="replaceable">code</code>',
    role=<code class="replaceable">role</code>,
    model_dir='<code class="replaceable">model_dir</code>',
    framework_version='<code class="replaceable">2.2</code>',
    py_version='<code class="replaceable">py37</code>',
    job_name='<code class="replaceable">my-training-job-1</code>',
    instance_type='<code class="replaceable">ml.g4dn.xlarge</code>',
    instance_count=<code class="replaceable">1</code>,
    volume_size=<code class="replaceable">250</code>,
    hyperparameters=<span>{</span>
"batch-size": <code class="replaceable">512</code>,
        "epochs": <code class="replaceable">1</code>,
        "learning-rate": <code class="replaceable">1e-3</code>,
        "beta_1": <code class="replaceable">0.9</code>,
        "beta_2": <code class="replaceable">0.999</code>,
    },
    keep_alive_period_in_seconds=<code class="replaceable">1800</code>,
    environment=<span>{</span>"PIP_CACHE_DIR": "/opt/ml/sagemaker/warmpoolcache/pip"}
)</code></pre>
            <p>In the previous code example, using the <a href="https://sagemaker.readthedocs.io/en/stable/api/training/estimators.html#estimators" rel="noopener noreferrer" target="_blank"><span>environment</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> parameter exports the environment variable
                    <code class="code">PIP_CACHE_DIRECTORY</code> to point to the directory
                    <code class="code">/opt/ml/sagemaker/warmpoolcache/pip</code>. Exporting this environment
                variable will change where pip stores its cache to the new location. Any directory,
                including nested directories, that you create inside the persistent cache directory
                will be available for re-use during a subsequent training run. In the previous code
                example, a directory called <code class="code">pip</code> is changed to be the default location
                to cache any dependencies installed using pip.</p>
            <p>The persistent cache location may also be accessed from within your Python
                training script using the environment variable as shown in the following code
                example.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">import os
import shutil
if __name__ == '__main__':
    PERSISTED_DIR = os.environ["SAGEMAKER_MANAGED_WARMPOOL_CACHE_DIRECTORY"]

    # create a file to be persisted
    open(os.path.join(PERSISTED_DIR, "<code class="replaceable">test.txt</code>"), 'a').close()
    # create a directory to be persisted
    os.mkdir(os.path.join(PERSISTED_DIR, "<code class="replaceable">test_dir</code>"))

    # Move a file to be persisted
    shutil.move("<code class="replaceable">path/of/your/file.txt</code>", PERSISTED_DIR)</code></pre>
         
         
            <h3 id="train-warm-pools-billing">Billing</h3>
            <p>SageMaker managed warm pools are a billable resource. Retrieve the warm pool status for
                your training job to check the billable time for your warm pools. You can check the
                warm pool status either through the <a href="train-warm-pools.html#train-warm-pools-how-to-use-sagemaker-console">Using the Amazon SageMaker
                    console</a> or directly
                through the <a href="https://docs.aws.amazon.com/sagemaker/latest/APIReference/API_DescribeTrainingJob.html">DescribeTrainingJob</a> API command. For more information, see <a href="https://docs.aws.amazon.com/sagemaker/latest/APIReference/API_WarmPoolStatus.html">WarmPoolStatus</a> in the <em>Amazon SageMaker API
                    Reference</em>.</p>
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>After the time specified by the parameter
                        <code class="code">KeepAlivePeriodInSeconds</code> has ended, both the warm pool and
                    persistent cache will shut down, and the contents will be deleted.</p></div></div>
         
     
        <h2 id="train-warm-pools-resource-limits">Warm pool resource limits</h2>
        <p>To get started, you must first request a service limit increase for SageMaker managed warm
            pools. The default resource limit for warm pools is 0.</p>
        <p>If a training job is created with <code class="code">KeepAlivePeriodInSeconds</code> specified, but
            you did not request a warm pool limit increase, then a warm pool is not retained after
            the completion of the training job. A warm pool is only created if your warm pool limit
            has sufficient resources. After a warm pool is created, the resources are released when
            they move to a matching training job or if the <code class="code">KeepAlivePeriodInSeconds</code>
            expires (if the warm pool status is <code class="code">Reused</code> or
            <code class="code">Terminated</code>).</p>
         
            <h3 id="train-warm-pools-resource-limits-request">Request a warm pool quota
                    increase</h3>
            <p>Request a warm pool quota increase using the AWS Service Quotas console.</p>
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>All warm pool instance usage counts toward your SageMaker training resource limit.
                    Increasing your warm pool resource limit does not increase your instance limit,
                    but allocates a subset of your resource limit to warm pool training.</p></div></div>
            <div class="orderedlist">
                 
                 
                 
                 
                 
                 
                 
            <ol><li>
                    <p>Open the <a href="https://console.aws.amazon.com/servicequotas/home/" rel="noopener noreferrer" target="_blank"><span>AWS Service
                            Quotas console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
                </li><li>
                    <p>On the left-hand navigation panel, choose <b>AWS
                            services</b>.</p>
                </li><li>
                    <p>Search for and choose <b>Amazon SageMaker</b>.</p>
                </li><li>
                    <p>Search for the keyword <code class="userinput">warm pool</code> to see all
                        available warm pool service quotas.</p>
                </li><li>
                    <p>Find the instance type for which you want to increase your warm pool
                        quota, select the warm pool service quota for that instance type, and choose
                            <b>Request quota increase</b>.</p>
                </li><li>
                    <p>Enter your requested instance limit number under <b>Change quota
                            value</b>. The new value must be greater than the current
                            <b>Applied quota value</b>.</p>
                </li><li>
                    <p>Choose <b>Request</b>.</p>
                </li></ol></div>
            <p>There is a limit on the number of instances that you can retain for each account,
                which is determined by instance type. You can check your resource limits in the
                    <a href="https://console.aws.amazon.com/servicequotas/home/" rel="noopener noreferrer" target="_blank"><span>AWS Service Quotas
                    console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> or directly using the <a href="https://docs.aws.amazon.com/cli/latest/reference/service-quotas/list-service-quotas.html">list-service-quotas</a> AWS CLI command. For more information on AWS
                Service Quotas, see <a href="https://docs.aws.amazon.com/servicequotas/latest/userguide/request-quota-increase.html">Requesting a
                    quota increase</a> in the <em>Service Quotas User
                    Guide</em>. </p>
            <p>You can also use <a href="https://support.console.aws.amazon.com" rel="noopener noreferrer" target="_blank"><span>AWS Support
                    Center</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> to request a warm pool quota increase. For a list of available
                instance types according to Region, see <a href="http://aws.amazon.com/sagemaker/pricing/" rel="noopener noreferrer" target="_blank"><span>Amazon SageMaker Pricing</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> and choose
                    <b>Training</b> in the <b>On-Demand Pricing</b>
                table.</p>
         
     
        <h2 id="train-warm-pools-how-to-use">How to use SageMaker managed warm pools</h2>
        <p>You can use SageMaker managed warm pools through the SageMaker Python SDK, the Amazon SageMaker console,
            or through the low-level APIs. Administrators can optionally use the
                <code class="code">sagemaker:KeepAlivePeriod</code> condition key to further restrict the
                <code class="code">KeepAlivePeriodInSeconds</code> limits for certain users or groups.</p>
        <div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="train-warm-pools.html#train-warm-pools-how-to-use-python-sdk">Using the SageMaker Python
                    SDK</a></li><li><a href="train-warm-pools.html#train-warm-pools-how-to-use-sagemaker-console">Using the Amazon SageMaker
                    console</a></li><li><a href="train-warm-pools.html#train-warm-pools-how-to-use-low-level-apis">Using the low-level
                    SageMaker APIs</a></li><li><a href="train-warm-pools.html#train-warm-pools-how-to-use-iam-condition-key">IAM condition
                    key</a></li></ul></div>
         
            <h3 id="train-warm-pools-how-to-use-python-sdk">Using the SageMaker Python
                    SDK</h3>
            <p>Create, update, or terminate warm pools using the SageMaker Python SDK.</p>
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>This feature is available in the SageMaker <a href="https://pypi.org/project/sagemaker/2.110.0/" rel="noopener noreferrer" target="_blank"><span>Python SDK
                        v2.110.0</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> and later.</p></div></div>
            <div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="train-warm-pools.html#train-warm-pools-how-to-use-python-sdk-create">Create a warm
                        pool</a></li><li><a href="train-warm-pools.html#train-warm-pools-how-to-use-python-sdk-update">Update a warm
                        pool</a></li><li><a href="train-warm-pools.html#train-warm-pools-how-to-use-python-sdk-terminate">Terminate a
                        warm pool</a></li></ul></div>
             
                <h4 id="train-warm-pools-how-to-use-python-sdk-create">Create a warm
                        pool</h4>
                <p>To create a warm pool, use the SageMaker Python SDK to create an estimator with a
                        <code class="code">keep_alive_period_in_seconds</code> value greater than 0 and call
                        <code class="code">fit()</code>. When the training job completes, a warm pool is
                    retained. For more information on training scripts and estimators, see <a href="https://sagemaker.readthedocs.io/en/stable/overview.html#train-a-model-with-the-sagemaker-python-sdk" rel="noopener noreferrer" target="_blank"><span>Train a Model with the SageMaker Python SDK</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. If your script does not
                    create a warm pool, see <a href="train-warm-pools.html#train-warm-pools-creation">Warm pool creation</a> for possible
                    explanations.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import sagemaker
from sagemaker import get_execution_role
from sagemaker.tensorflow import TensorFlow

# Creates a SageMaker session and gets execution role
session = sagemaker.Session()
role = get_execution_role()

# Creates an example estimator
estimator = TensorFlow(
    ...
    entry_point=<code class="replaceable">'my-training-script.py'</code>,
    source_dir=<code class="replaceable">'code'</code>,
    role=<code class="replaceable">role</code>,
    model_dir=<code class="replaceable">'model_dir'</code>,
    framework_version=<code class="replaceable">'2.2'</code>,
    py_version=<code class="replaceable">'py37'</code>,
    job_name=<code class="replaceable">'my-training-job-1'</code>,
    instance_type=<code class="replaceable">'ml.g4dn.xlarge'</code>,
    instance_count=<code class="replaceable">1</code>,
    volume_size=<code class="replaceable">250</code>,
    hyperparameters=<span>{</span>
        "batch-size": <code class="replaceable">512</code>,
        "epochs": <code class="replaceable">1</code>,
        "learning-rate": <code class="replaceable">1e-3</code>,
        "beta_1": <code class="replaceable">0.9</code>,
        "beta_2": <code class="replaceable">0.999</code>,
    },
    keep_alive_period_in_seconds=<code class="replaceable">1800</code>,
)

# Starts a SageMaker training job and waits until completion
estimator.fit(<code class="replaceable">'s3://my_bucket/my_training_data/'</code>)             </code></pre>
                <p>Next, create a second matching training job. In this example, we create
                        <code class="code">my-training-job-2</code>, which has all of the necessary attributes to
                    match with <code class="code">my-training-job-1</code>, but has a different hyperparameter
                    for experimentation. The second training job reuses the warm pool and starts up
                    faster than the first training job. The following code example uses a Tensorflow
                    estimator. The warm pool feature can be used with any training algorithm that
                    runs on Amazon SageMaker. For more information on which attributes need to match, see
                        <a href="train-warm-pools.html#train-warm-pools-matching-criteria">Matching training jobs</a>.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python "># Creates an example estimator
estimator = TensorFlow(
    ...
    entry_point=<code class="replaceable">'my-training-script.py'</code>,
    source_dir=<code class="replaceable">'code'</code>,
    role=<code class="replaceable">role</code>,
    model_dir=<code class="replaceable">'model_dir'</code>,
    framework_version=<code class="replaceable">'py37'</code>,
    py_version=<code class="replaceable">'pyxy'</code>,
    job_name=<code class="replaceable">'my-training-job-2'</code>,
    instance_type=<code class="replaceable">'ml.g4dn.xlarge'</code>,
    instance_count=<code class="replaceable">1</code>,
    volume_size=<code class="replaceable">250</code>,
    hyperparameters=<span>{</span>
        "batch-size": <code class="replaceable">512</code>,
        "epochs": <code class="replaceable">2</code>,
        "learning-rate": <code class="replaceable">1e-3</code>,
        "beta_1": <code class="replaceable">0.9</code>,
        "beta_2": <code class="replaceable">0.999</code>,
    },
    keep_alive_period_in_seconds=<code class="replaceable">1800</code>,
)

# Starts a SageMaker training job and waits until completion
estimator.fit(<code class="replaceable">'s3://my_bucket/my_training_data/'</code>)           </code></pre>
                <p>Check the warm pool status of both training jobs to confirm that the warm pool
                    is <code class="code">Reused</code> for <code class="code">my-training-job-1</code> and <code class="code">InUse</code>
                    for <code class="code">my-training-job-2</code>.</p>
                <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Training job names have date/time suffixes. The example training job names
                            <code class="code">my-training-job-1</code> and <code class="code">my-training-job-2</code> should
                        be replaced with actual training job names. You can use the
                            <code class="code">estimator.latest_training_job.job_name</code> command to fetch the
                        actual training job name.</p></div></div>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">session.describe_training_job(<code class="replaceable">'my-training-job-1'</code>)
session.describe_training_job(<code class="replaceable">'my-training-job-2'</code>)</code></pre>
                <p>The result of <code class="code">describe_training_job</code> provides all details about a
                    given training job. Find the <code class="code">WarmPoolStatus</code> attribute to check
                    information about a training job’s warm pool. Your output should look similar to
                    the following example:</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "># Warm pool status for training-job-1
...
'WarmPoolStatus': <span>{</span>'Status': 'Reused', 
  'ResourceRetainedBillableTimeInSeconds': 1000,
  'ReusedByName': my-training-job-2}
...

# Warm pool status for training-job-2
... 
'WarmPoolStatus': <span>{</span>'Status': 'InUse'}
...             </code></pre>
             
             
                <h4 id="train-warm-pools-how-to-use-python-sdk-update">Update a warm
                        pool</h4>
                <p>When the training job is complete and the warm pool status is
                        <code class="code">Available</code>, then you can update the
                        <code class="code">KeepAlivePeriodInSeconds</code> value.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">session.update_training_job(job_name, resource_config=<span>{</span>"KeepAlivePeriodInSeconds":<code class="replaceable">3600</code>})</code></pre>
             
             
                <h4 id="train-warm-pools-how-to-use-python-sdk-terminate">Terminate a
                        warm pool</h4>
                <p>To manually terminate a warm pool, set the <code class="code">KeepAlivePeriodInSeconds
                    </code> value to 0.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">session.update_training_job(job_name, resource_config=<span>{</span>"KeepAlivePeriodInSeconds":0})</code></pre>
                <p>The warm pool automatically terminates when it exceeds the designated
                        <code class="code">KeepAlivePeriodInSeconds</code> value or if there is a patch update
                    for the cluster.</p>
             
         
         
            <h3 id="train-warm-pools-how-to-use-sagemaker-console">Using the Amazon SageMaker
                    console</h3>
            <p>Through the console, you can create a warm pool, release a warm pool, or check the
                warm pool status and billable time of specific training jobs. You can also see which
                matching training job reused a warm pool.</p>
            <div class="procedure"><ol><li>
                    <p>Open the <a href="https://console.aws.amazon.com/ec2/" rel="noopener noreferrer" target="_blank"><span>Amazon SageMaker console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> and
                        choose <b>Training jobs</b> from the navigation pane. If
                        applicable, the warm pool status of each training job is visible in the
                            <b>Warm pool status</b> column and the time left for an
                        active warm pool is visible in the <b>Time left</b>
                        column.</p>
                </li><li>
                    <p>To create a training job that uses a warm pool from the console, choose
                            <b>Create training job</b>. Then, be sure to specify a
                        value for the <b>Keep alive period</b> field when configuring
                        your training job resources. This value must be an integer between 1 and
                        3600, which represents duration of time in seconds.</p>
                </li><li>
                    <p>To release a warm pool from the console, select a specific training job
                        and choose <b>Release cluster</b> from the <b>Actions
                        </b>dropdown menu.</p>
                </li><li>
                    <p>To see more information about a warm pool, choose a training job name. In
                        the job details page, scroll down to the <b>Warm pool
                            status</b> section to find the warm pool status, the time left if
                        the warm pool status is <code class="code">Available</code>, the warm pool billable
                        seconds, and the name of the training job that reused the warm pool if the
                        warm pool status is <code class="code">Reused</code>.</p>
                </li></ol></div>
         
         
            <h3 id="train-warm-pools-how-to-use-low-level-apis">Using the low-level
                    SageMaker APIs</h3>
            <p>Use SageMaker managed warm pools with either the SageMaker API or the AWS CLI.</p>
             
                <h4 id="train-warm-pools-how-to-use-low-level-apis-sagemaker">SageMaker
                        API</h4>
                <p>Set up SageMaker managed warm pools using the SageMaker API with the following
                    commands:</p>
                <div class="itemizedlist">
                     
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p><a href="https://docs.aws.amazon.com/sagemaker/latest/APIReference/API_CreateTrainingJob.html">
                                CreateTrainingJob </a></p>
                    </li><li class="listitem">
                        <p><a href="https://docs.aws.amazon.com/sagemaker/latest/APIReference/API_UpdateTrainingJob.html">
                                UpdateTrainingJob </a></p>
                    </li><li class="listitem">
                        <p><a href="https://docs.aws.amazon.com/sagemaker/latest/APIReference/API_ListTrainingJobs.html">
                                ListTrainingJobs </a></p>
                    </li><li class="listitem">
                        <p><a href="https://docs.aws.amazon.com/sagemaker/latest/APIReference/API_DescribeTrainingJob.html">
                                DescribeTrainingJob </a></p>
                    </li></ul></div>
             
             
                <h4 id="train-warm-pools-how-to-use-low-level-apis-cli">AWS
                        CLI</h4>
                <p>Set up SageMaker managed warm pools using the AWS CLI with the following
                    commands:</p>
                <div class="itemizedlist">
                     
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p><a href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/sagemaker/create-training-job.html" rel="noopener noreferrer" target="_blank"><span>create-training-job</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
                    </li><li class="listitem">
                        <p><a href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/sagemaker/update-training-job.html" rel="noopener noreferrer" target="_blank"><span>update-training-job</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
                    </li><li class="listitem">
                        <p><a href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/sagemaker/list-training-jobs.html" rel="noopener noreferrer" target="_blank"><span>list-training-jobs</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
                    </li><li class="listitem">
                        <p><a href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/sagemaker/describe-training-job.html" rel="noopener noreferrer" target="_blank"><span>describe-training-job</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
                    </li></ul></div>
             
         
         
            <h3 id="train-warm-pools-how-to-use-iam-condition-key">IAM condition
                    key</h3>
            <p>Administrators can optionally use the <code class="code">sagemaker:KeepAlivePeriod</code>
                condition key to further restrict the <code class="code">KeepAlivePeriodInSeconds</code> limits
                for certain users or groups. SageMaker managed warm pools are limited to a
                    <code class="code">KeepAlivePeriodInSeconds</code> value of 3600 seconds (60 minutes), but
                administrators can lower this limit if needed. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "EnforceKeepAlivePeriodLimit",
            "Effect": "Allow",
            "Action": [
                "sagemaker:CreateTrainingJob"
            ],
            "Resource": "*",
            "Condition": <span>{</span>
                "NumericLessThanIfExists": <span>{</span>
                    "sagemaker:KeepAlivePeriod": <code class="replaceable">1800</code>
                }
            }
        }
    ]
}</code></pre>
            <p>For more information, see <a href="https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazonsagemaker.html#amazonsagemaker-policy-keys">Condition keys for Amazon SageMaker</a> in the <em>Service
                    Authorization Reference</em>.</p>
         
     
        <h2 id="train-warm-pools-considerations">Considerations</h2>
        <p>Consider the following items when using SageMaker managed warm pools.</p>
        <div class="itemizedlist">
             
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p>SageMaker managed warm pools cannot be used with heterogeneous cluster training. </p>

            </li><li class="listitem">
                <p>SageMaker managed warm pools cannot be used with spot instances.</p>

            </li><li class="listitem">
                <p>SageMaker managed warm pools are limited to a <code class="code">KeepAlivePeriodInSeconds</code>
                    value of 3600 seconds (60 minutes).</p>
            </li><li class="listitem">
                <p>If a warm pool continues to successfully match training jobs within the
                    specified <code class="code">KeepAlivePeriodInSeconds</code> value, the cluster can only
                    continue running for a maximum of 28 days.</p>
            </li></ul></div>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./model-managed-spot-training.html">Use Managed Spot Training</div><div id="next" class="next-link" accesskey="n" href="./training-metrics.html">Monitor and Analyze Using CloudWatch
            Metrics</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/train-warm-pools.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/train-warm-pools.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>