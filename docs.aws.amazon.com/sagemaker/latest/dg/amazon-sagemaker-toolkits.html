<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Using the SageMaker Training and Inference Toolkits - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="amazon-sagemaker-toolkits" /><meta name="default_state" content="amazon-sagemaker-toolkits" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="amazon-sagemaker-toolkits.html" /><meta name="description" content="How to use the SageMaker Training and Inference Toolkits with your own Docker containers." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="amazon-sagemaker-toolkits.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" hreflang="de" /><link rel="alternative" href="amazon-sagemaker-toolkits.html" hreflang="en-us" /><link rel="alternative" href="amazon-sagemaker-toolkits.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" hreflang="zh-tw" /><link rel="alternative" href="amazon-sagemaker-toolkits.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Using the SageMaker Training and Inference Toolkits" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Using the SageMaker Training and Inference Toolkits - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#amazon-sagemaker-toolkits" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/amazon-sagemaker-toolkits.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Use Docker containers to build models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/docker-containers.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Adapting your own Docker container to work with SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/docker-containers-adapt-your-own.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Using the SageMaker Training and Inference Toolkits",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/docker-containers-adapt-your-own.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#amazon-sagemaker-toolkits" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="page-toc-src"><a href="amazon-sagemaker-toolkits.html#sagemaker-toolkits-structure">SageMaker Toolkits Containers
                Structure</a><a href="amazon-sagemaker-toolkits.html#sagemaker-toolkits-separate-images">Single Versus Multiple
                Containers</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="amazon-sagemaker-toolkits">Using the SageMaker Training and Inference Toolkits </h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>The <a href="https://github.com/aws/sagemaker-training-toolkit" rel="noopener noreferrer" target="_blank"><span>SageMaker Training</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>
        and <a href="https://github.com/aws/sagemaker-inference-toolkit" rel="noopener noreferrer" target="_blank"><span>SageMaker Inference</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>
        toolkits implement the functionality that you need to adapt your containers to run scripts,
        train algorithms, and deploy models on SageMaker. When installed, the library defines the
        following for users:</p><div class="itemizedlist">
         
         
         
    <ul class="itemizedlist"><li class="listitem">
            <p>The locations for storing code and other resources. </p>
        </li><li class="listitem">
            <p>The entry point that contains the code to run when the container is started. Your
                Dockerfile must copy the code that needs to be run into the location expected by a
                container that is compatible with SageMaker. </p>
        </li><li class="listitem">
            <p>Other information that a container needs to manage deployments for training and
                inference. </p>
        </li></ul></div>
        <h2 id="sagemaker-toolkits-structure">SageMaker Toolkits Containers
                Structure</h2>
        <p>When SageMaker trains a model, it creates the following file folder structure in the
            container's <code>/opt/ml</code> directory.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">/opt/ml
├── input
│   ├── config
│   │   ├── hyperparameters.json
│   │   └── resourceConfig.json
│   └── data
│       └── &lt;channel_name&gt;
│           └── &lt;input data&gt;
├── model
│
├── code
│
├── output
│
└── failure</code></pre>
        <p>When you run a model <em>training</em> job, the SageMaker container uses the
                <code>/opt/ml/input/</code> directory, which contains the JSON files that
            configure the hyperparameters for the algorithm and the network layout used for
            distributed training. The <code>/opt/ml/input/</code> directory also contains
            files that specify the channels through which SageMaker accesses the data, which is stored in
            Amazon Simple Storage Service (Amazon S3). The SageMaker containers library places the scripts that the container will
            run in the <code>/opt/ml/code/</code> directory. Your script should write the
            model generated by your algorithm to the <code>/opt/ml/model/</code> directory.
            For more information, see <a href="your-algorithms-training-algo.html">Use Your Own Training Algorithms</a>.</p>
        <p>When you <em>host</em> a trained model on SageMaker to make inferences, you
            deploy the model to an HTTP endpoint. The model makes real-time predictions in response
            to inference requests. The container must contain a serving stack to process these
            requests.</p>
        <p>In a hosting or batch transform container, the model files are located in the same
            folder to which they were written during training.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">/opt/ml/model
│
└── &lt;model files&gt;</code></pre>
        <p>For more information, see <a href="your-algorithms-inference-main.html">Use your own inference code</a>.</p>
     
        <h2 id="sagemaker-toolkits-separate-images">Single Versus Multiple
                Containers</h2>
        <p>You can either provide separate Docker images for the training algorithm and inference
            code or you can use a single Docker image for both. When creating Docker images for use
            with SageMaker, consider the following:</p>
        <div class="itemizedlist">
             
             
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p>Providing two Docker images can increase storage requirements and cost because
                    common libraries might be duplicated.</p>
            </li><li class="listitem">
                <p>In general, smaller containers start faster for both training and hosting.
                    Models train faster and the hosting service can react to increases in traffic by
                    automatically scaling more quickly.</p>
            </li><li class="listitem">
                <p>You might be able to write an inference container that is significantly
                    smaller than the training container. This is especially common when you use GPUs
                    for training, but your inference code is optimized for CPUs.</p>
            </li><li class="listitem">
                <p>SageMaker requires that Docker containers run without privileged access.</p>
            </li><li class="listitem">
                <p>Both Docker containers that you build and those provided by SageMaker can send
                    messages to the <code class="code">Stdout</code> and <code class="code">Stderr</code> files. SageMaker sends
                    these messages to Amazon CloudWatch logs in your AWS account.</p>
            </li></ul></div>
        <p>For more information about how to create SageMaker containers and how scripts are executed
            inside them, see the <a href="https://github.com/aws/sagemaker-training-toolkit" rel="noopener noreferrer" target="_blank"><span>SageMaker
                Training Toolkit</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> and <a href="https://github.com/aws/sagemaker-inference-toolkit" rel="noopener noreferrer" target="_blank"><span>SageMaker Inference
                Toolkit</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> repositories on GitHub. They also provide lists of important
            environmental variables and the environmental variables provided by SageMaker
            containers.</p>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./docker-containers-adapt-your-own.html">Adapting your own Docker container to
                work with SageMaker</div><div id="next" class="next-link" accesskey="n" href="./adapt-training-container.html">Adapting your own training container</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/amazon-sagemaker-toolkits.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/amazon-sagemaker-toolkits.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>