<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Check prediction results - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="async-inference-check-predictions" /><meta name="default_state" content="async-inference-check-predictions" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="async-inference-check-predictions.html" /><meta name="description" content="Use this page to learn how to check the output of your predictions from your asynchronous endpoints." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="async-inference-check-predictions.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/async-inference-check-predictions.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/async-inference-check-predictions.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/async-inference-check-predictions.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/async-inference-check-predictions.html" hreflang="de" /><link rel="alternative" href="async-inference-check-predictions.html" hreflang="en-us" /><link rel="alternative" href="async-inference-check-predictions.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/async-inference-check-predictions.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/async-inference-check-predictions.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/async-inference-check-predictions.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/async-inference-check-predictions.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/async-inference-check-predictions.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/async-inference-check-predictions.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/async-inference-check-predictions.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/async-inference-check-predictions.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/async-inference-check-predictions.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/async-inference-check-predictions.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/async-inference-check-predictions.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/async-inference-check-predictions.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/async-inference-check-predictions.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/async-inference-check-predictions.html" hreflang="zh-tw" /><link rel="alternative" href="async-inference-check-predictions.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Check prediction results" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Check prediction results - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#async-inference-check-predictions" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/async-inference-check-predictions.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/async-inference-check-predictions.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/async-inference-check-predictions.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance,inference,deploy model,endpoint,prediction,ML application,serverless machine learning,multi model deployment,inference pipelines,ML model" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Deploy models for inference",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/deploy-model.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Asynchronous inference",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/async-inference.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Check prediction results",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/async-inference.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#async-inference-check-predictions" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="page-toc-src"><a href="async-inference-check-predictions.html#async-inference-check-predictions-sns-topic">Amazon SNS Topics</a><a href="async-inference-check-predictions.html#async-inference-check-predictions-s3-bucket">Check Your S3 Bucket</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="async-inference-check-predictions">Check prediction results</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>There are several ways you can check predictions results from your asynchronous endpoint.
        Some options are:</p><div class="orderedlist">
         
         
    <ol><li><p>Amazon SNS topics.</p></li><li><p>Check for outputs in your Amazon S3 bucket.</p></li></ol></div>
        <h2 id="async-inference-check-predictions-sns-topic">Amazon SNS Topics</h2>
        <p>Amazon SNS is a notification service for messaging-oriented applications, with multiple
            subscribers requesting and receiving "push" notifications of time-critical messages via
            a choice of transport protocols, including HTTP, Amazon SQS, and email. Amazon SageMaker Asynchronous Inference posts
            notifications when you create an endpoint with <a href="https://docs.aws.amazon.com/sagemaker/latest/APIReference/API_CreateEndpointConfig.html"><code class="code">CreateEndpointConfig</code></a> and specify an Amazon SNS topic.</p>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>In order to receive Amazon SNS notifications, your IAM role must 
            have <code class="code">sns:Publish</code> permissions. See 
            the <a href="async-inference-create-endpoint-prerequisites.html">Prerequisites</a>
            for information on requirements you must satisfy to use Asynchronous Inference.</p></div></div>
        <p>To use Amazon SNS to check prediction results from your asynchronous endpoint, you first
            need to create a topic, subscribe to the topic, confirm your subscription to the topic,
            and note the Amazon Resource Name (ARN) of that topic. For detailed information on how
            to create, subscribe, and find the Amazon ARN of an Amazon SNS topic, see <a href="https://docs.aws.amazon.com/sns/latest/dg/sns-configuring.html">Configuring
                Amazon SNS</a>.</p>
        <p>Provide the Amazon SNS topic ARN(s) in the <code class="code">AsyncInferenceConfig</code> field when you
            create an endpoint configuration with <code class="code">CreateEndpointConfig</code>. You can specify
            both an Amazon SNS <code class="code">ErrorTopic</code> and an <code class="code">SuccessTopic</code>.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import boto3

sagemaker_client = boto3.client('sagemaker', region_name=&lt;aws_region&gt;)

sagemaker_client.create_endpoint_config(
    EndpointConfigName=<code class="replaceable">&lt;endpoint_config_name&gt;</code>, # You specify this name in a CreateEndpoint request.
    # List of ProductionVariant objects, one for each model that you want to host at this endpoint.
    ProductionVariants=[
        <span>{</span>
            "VariantName": <code class="replaceable">"variant1"</code>, # The name of the production variant.
            "ModelName": <code class="replaceable">"model_name"</code>, 
            "InstanceType": <code class="replaceable">"ml.m5.xlarge"</code>, # Specify the compute instance type.
            "InitialInstanceCount": <code class="replaceable">1</code> # Number of instances to launch initially.
        }
    ],
    AsyncInferenceConfig=<span>{</span>
        "OutputConfig": <span>{</span>
            # Location to upload response outputs when no location is provided in the request.
            "S3OutputPath": "s3://<code class="replaceable">&lt;bucket&gt;/&lt;output_directory&gt;</code>"
            "NotificationConfig": <span>{</span>
                "SuccessTopic": "arn:aws:sns:<code class="replaceable">aws-region:account-id:topic-name</code>",
                "ErrorTopic": "arn:aws:sns:<code class="replaceable">aws-region:account-id:topic-name</code>",
            }
        }
    }
)</code></pre>
        <p>After creating your endpoint and invoking it, you receive a notification from your Amazon SNS topic. For example,
            if you subscribed to receive email notifications from your topic, you receive an email notification every time you
            invoke your endpoint. The following example shows the JSON content of a successful invocation email notification.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "awsRegion":"us-east-1",
   "eventTime":"2022-01-25T22:46:00.608Z",
   "receivedTime":"2022-01-25T22:46:00.455Z",
   "invocationStatus":"Completed",
   "requestParameters":<span>{</span>
      "contentType":"text/csv",
      "endpointName":"<code class="replaceable">&lt;example-endpoint&gt;</code>",
      "inputLocation":"s3://<code class="replaceable">&lt;bucket&gt;</code>/<code class="replaceable">&lt;input-directory&gt;</code>/input-data.csv"
   },
   "responseParameters":<span>{</span>
      "contentType":"text/csv; charset=utf-8",
      "outputLocation":"s3://<code class="replaceable">&lt;bucket&gt;</code>/<code class="replaceable">&lt;output_directory&gt;</code>/prediction.out"
   },
   "inferenceId":"11111111-2222-3333-4444-555555555555", 
   "eventVersion":"1.0",
   "eventSource":"aws:sagemaker",
   "eventName":"InferenceResult"
}</code></pre>
        
     
        <h2 id="async-inference-check-predictions-s3-bucket">Check Your S3 Bucket</h2>
        <p>When you invoke an endpoint with <code class="code">InvokeEndpointAsync</code>, it returns a
            response object. You can use the response object to get the Amazon S3 URI where your output
            is stored. With the output location, you can use a SageMaker Python SDK SageMaker session class to
            programmatically check for on an output.</p>
        <p>The following stores the output dictionary of <code class="code">InvokeEndpointAsync</code> as a
            variable named response. With the response variable, you then get the Amazon S3 output URI
            and store it as a string variable called <code class="code">output_location</code>. </p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import uuid
import boto3

sagemaker_runtime = boto3.client("sagemaker-runtime", region_name=<code class="replaceable">&lt;aws_region&gt;</code>)

# Specify the S3 URI of the input. Here, a single SVM sample
input_location = "s3://<code class="replaceable">bucket-name/test_point_0.libsvm</code>" 

response = sagemaker_runtime.invoke_endpoint_async(
    EndpointName=<code class="replaceable">'&lt;endpoint-name&gt;'</code>,
    InputLocation=input_location,
    InferenceId=str(uuid.uuid4()), 
    ContentType=<code class="replaceable">"text/libsvm"</code> #Specify the content type of your data
)

output_location = response['OutputLocation']
print(f"OutputLocation: <span>{</span>output_location}")</code></pre>
        
        <p>For information about supported content types, see <a href="cdf-inference.html">Common Data Formats for Inference</a>.</p>
        <p>With the Amazon S3 output location, you can then use a 
            <a href="https://sagemaker.readthedocs.io/en/stable/api/utility/session.html?highlight=session" rel="noopener noreferrer" target="_blank"><span>SageMaker Python SDK SageMaker Session Class</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> 
            to read in Amazon S3 files. The following code example shows how to create a function 
            (<code class="code">get_ouput</code>) that repeatedly attempts to read a file from the Amazon S3 output location:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import sagemaker
import urllib, time
from botocore.exceptions import ClientError

sagemaker_session = sagemaker.session.Session()

def get_output(output_location):
    output_url = urllib.parse.urlparse(output_location)
    bucket = output_url.netloc
    key = output_url.path[1:]
    while True:
        try:
            return sagemaker_session.read_s3_file(
                                        bucket=output_url.netloc, 
                                        key_prefix=output_url.path[1:])
        except ClientError as e:
            if e.response['Error']['Code'] == 'NoSuchKey':
                print("waiting for output...")
                time.sleep(2)
                continue
            raise
            
output = get_output(output_location)
print(f"Output: <span>{</span>output}")</code></pre>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./async-inference-monitor.html">Monitor asynchronous endpoint</div><div id="next" class="next-link" accesskey="n" href="./async-inference-autoscale.html">Autoscale an asynchronous endpoint</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/async-inference-check-predictions.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/async-inference-check-predictions.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>