<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Baseline calculation, drift detection and lifecycle with ClarifyCheck and QualityCheck steps in Amazon SageMaker Model Building Pipelines - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="pipelines-quality-clarify-baseline-lifecycle" /><meta name="default_state" content="pipelines-quality-clarify-baseline-lifecycle" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="pipelines-quality-clarify-baseline-lifecycle.html" /><meta name="description" content="Working with baselines in ClarifyCheck and QualityCheck steps in SageMaker Pipelines" /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="pipelines-quality-clarify-baseline-lifecycle.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" hreflang="de" /><link rel="alternative" href="pipelines-quality-clarify-baseline-lifecycle.html" hreflang="en-us" /><link rel="alternative" href="pipelines-quality-clarify-baseline-lifecycle.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" hreflang="zh-tw" /><link rel="alternative" href="pipelines-quality-clarify-baseline-lifecycle.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Baseline calculation, drift detection and lifecycle with ClarifyCheck and QualityCheck steps in Amazon SageMaker Model Building Pipelines" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Baseline calculation, drift detection and lifecycle with ClarifyCheck and QualityCheck steps in Amazon SageMaker Model Building Pipelines - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#pipelines-quality-clarify-baseline-lifecycle" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Implement MLOps",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/mlops.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "SageMaker Workflows",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/workflows.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Amazon SageMaker Model Building Pipelines",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/pipelines.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "SageMaker Pipelines Overview",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/pipelines-sdk.html"
      },
      {
        "@type" : "ListItem",
        "position" : 8,
        "name" : "Baseline calculation, drift detection and lifecycle with ClarifyCheck and QualityCheck steps in Amazon SageMaker Model Building Pipelines",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/pipelines-sdk.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#pipelines-quality-clarify-baseline-lifecycle" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="page-toc-src"><a href="pipelines-quality-clarify-baseline-lifecycle.html#pipelines-quality-clarify-baseline-calculations">Baseline
        calculation and registration</a><a href="pipelines-quality-clarify-baseline-lifecycle.html#pipelines-quality-clarify-baseline-drift-detection">Drift
        Detection</a><a href="pipelines-quality-clarify-baseline-lifecycle.html#pipelines-quality-clarify-baseline-evolution">Baseline Lifecycle
        and Evolution</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="pipelines-quality-clarify-baseline-lifecycle">Baseline calculation, drift
      detection and lifecycle with ClarifyCheck and QualityCheck steps in Amazon SageMaker Model Building Pipelines</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>The following topic discusses how baselines and model versions evolve in the Amazon SageMaker Model Building Pipelines when
    using the <a href="build-and-manage-steps.html#step-type-clarify-check">ClarifyCheck</a> and <a href="build-and-manage-steps.html#step-type-quality-check">QualityCheck</a>
    steps.</p><p>For the <code class="code">ClarifyCheck</code> step, a baseline is a single file that resides in the step
    properties with the suffix <code class="code">constraints</code>. For the <code class="code">QualityCheck</code> step, a
    baseline is a combination of two files that resides in the step properties: one with the suffix
      <code class="code">statistics</code> and the other with the suffix <code class="code">constraints</code>. In the
    following topics we discuss these properties with a prefix that describes how they are used,
    impacting baseline behavior and lifecycle in these two pipeline steps. For example, the
      <code class="code">ClarifyCheck</code> step always calculates and assigns the new baselines in the
      <code class="code">CalculatedBaselineConstraints</code> property and the <code class="code">QualityCheck</code> step
    does the same in the <code class="code">CalculatedBaselineConstraints</code> and
      <code class="code">CalculatedBaselineStatistics</code> properties.</p>
    <h2 id="pipelines-quality-clarify-baseline-calculations">Baseline calculation and
        registration for ClarifyCheck and QualityCheck steps</h2>
    <p>Both the <code class="code">ClarifyCheck</code> and <code class="code">QualityCheck</code> steps always calculate
      new baselines based on step inputs through the underlying processing job run. These newly
      calculated baselines are accessed through the properties with the prefix
        <code class="code">CalculatedBaseline</code>. You can record these properties as the
        <code class="code">ModelMetrics</code> of your model package in the <a href="build-and-manage-steps.html#step-type-model">Model Step</a>. This model package can be registered with 5 different
      baselines. You can register it with one for each check type: data bias, model bias, and model
      explainability from running the <code class="code">ClarifyCheck</code> step and model quality, and data
      quality from running the <code class="code">QualityCheck</code> step. The
        <code class="code">register_new_baseline</code> parameter dictates the value set in the properties with
      the prefix <code class="code">BaselineUsedForDriftCheck</code> after a step runs.</p>
    <p>The following table of potential use cases shows different behaviors resulting from the
      step parameters you can set for the <code class="code">ClarifyCheck</code> and <code class="code">QualityCheck</code>
      steps:</p>
    <div class="table-container"><div class="table-contents"><table id="w714aac27c11c17c29c29b7b7"><thead>
          <tr>
            <th>Possible use case that you may consider for selecting this configuration </th>
            <th><code class="code">skip_check</code> / <code class="code">register_new_baseline</code></th>
            <th>Does step do a drift check?</th>
            <th>Value of step property <code class="code">CalculatedBaseline</code></th>
            <th>Value of step property <code class="code">BaselineUsedForDriftCheck</code></th>
          </tr>
        </thead>
          <tr>
            <td tabindex="-1"><p>You are doing regular retraining with checks enabled to get a new model
                version, but you <em>want to carry over the previous baselines</em> as
                the <code class="code">DriftCheckBaselines</code> in the model registry for your new model
                version.</p></td>
            <td tabindex="-1"><code class="code">False</code>/ <code class="code">False</code></td>
            <td tabindex="-1">Drift check runs against existing baselines</td>
            <td tabindex="-1">New baselines calculated by running the step</td>
            <td tabindex="-1">Baseline from the latest approved model in Model Registry or the baseline
              supplied as step parameter</td>
          </tr>
          <tr>
            <td tabindex="-1"><p>You are doing regular retraining with checks enabled to get a new model
                version, but you <em>want to refresh the <code class="code">DriftCheckBaselines</code> in
                  the model registry with the newly calculated baselines</em> for your new
                model version.</p></td>
            <td tabindex="-1"><code class="code">False</code>/ <code class="code">True</code></td>
            <td tabindex="-1">Drift check runs against existing baselines</td>
            <td tabindex="-1">New baselines calculated by running the step</td>
            <td tabindex="-1">Newly calculated baseline by running the step (value of property
                <code class="code">CalculatedBaseline</code>)</td>
          </tr>
          <tr>
            <td tabindex="-1"><p>You are initiating the pipeline to retrain a new model version because
                there is a violation detected by Amazon SageMaker Model Monitor on an endpoint for a particular type of
                check, and you want to <em>skip this type of check against the previous
                  baseline, but carry over the previous baseline as <code class="code">DriftCheckBaselines</code>
                  in the model registry</em> for your new model version.</p></td>
            <td tabindex="-1"><code class="code">True</code>/ <code class="code">False</code></td>
            <td tabindex="-1">No drift check</td>
            <td tabindex="-1">New baselines calculated by running</td>
            <td tabindex="-1">Baseline from the latest approved model in the model registry or the baseline
              supplied as step parameter</td>
          </tr>
          <tr>
            <td tabindex="-1">This happens in the following cases: <div class="itemizedlist">
                 
                 
              <ul class="itemizedlist"><li class="listitem">
                  <p>You are starting the initial run of the pipeline, building your first model
                    version, and generating the initial baselines.</p>
                </li><li class="listitem">
                  <p>You are initiating the pipeline to retrain a new model version because there
                    is a violation detected by Model Monitor on the endpoint for a particular type of check.
                    If you want to <em>skip the check against the previous baseline and
                      refresh the <code class="code">DriftCheckBaselines</code> with the newly calculated
                      baseline</em> in the model registry directly.</p>
                </li></ul></div>
            </td>
            <td tabindex="-1"><code class="code">True</code>/ <code class="code">True</code></td>
            <td tabindex="-1">No drift check</td>
            <td tabindex="-1">New baselines calculated by running the step</td>
            <td tabindex="-1">Newly calculated baseline by running the step (value of property
                <code class="code">CalculatedBaseline</code>)</td>
          </tr>
        </table></div></div>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>If you use scientific notation in your constraint, you need to convert to float. For a
        preprocessing script example of how to do this, see <a href="model-monitor-model-quality-baseline.html">Create a Model Quality
          Baseline</a>.</p></div></div>
    <p>When you register a model with <a href="build-and-manage-steps.html#step-type-model">Model Step</a>, you can register the
        <code class="code">BaselineUsedForDriftCheck</code> property as <code class="code">DriftCheckBaselines</code>. These
      baseline files can then be used by Model Monitor for model and data quality checks. In addition, these
      baselines can also be used in the ClarifyCheckStep and <code class="code">QualityCheck</code> step to
      compare newly trained models against the existing models that are registered in the model
      registry for future pipeline runs.</p>
   
    <h2 id="pipelines-quality-clarify-baseline-drift-detection">Drift Detection against
        Previous Baselines in SageMaker Pipelines</h2>
    <p>In the case of the <code class="code">QualityCheck</code> step, when you initiate the pipeline for
      regular retraining to get a new model version, you may not want to run the training step if
      the data quality and the data bias has <a href="model-monitor-interpreting-violations.html">Schema for Violations
                    (constraint_violations.json file)</a> on the baselines of your
      previous approved model version. You also may not want to register the newly trained model
      version if the model quality, model bias, or model explainability violates the registered
      baseline of your previous approved model version when running the <code class="code">ClarifyCheck</code>
      step. In these cases, you can enable the checks you want by setting the
        <code class="code">skip_check</code> property of the corresponding check step set to <code class="code">False</code>,
      resulting in the <code class="code">ClarifyCheck</code> and <code class="code">QualityCheck</code> step failing if
      violation is detected against previous baselines. The pipeline process then does not proceed
      so that the model drifted from the baseline isn't registered. <code class="code">ClarifyCheck</code> and
        <code class="code">QualityCheck</code> steps are able to get <code class="code">DriftCheckBaselines</code> of the
      latest approved model version of a given model package group against which to compare.
      Previous baselines can also be supplied directly through
        <code class="code">supplied_baseline_constraints</code> (in addition to
        <code class="code">supplied_baseline_statistics</code> if it is a <code class="code">QualityCheck</code> step) and are
      always prioritized over any baselines pulled from the model package group. </p>
   
    <h2 id="pipelines-quality-clarify-baseline-evolution">Baseline and model version
        lifecycle and evolution with SageMaker Pipelines</h2>
    <p>By setting <code class="code">register_new_baseline</code> of your <code class="code">ClarifyCheck</code> and
        <code class="code">QualityCheck</code> step to <code class="code">False</code>, your previous baseline is accessible
      through the step property prefix <code class="code">BaselineUsedForDriftCheck</code>. You can then register
      these baselines as the <code class="code">DriftCheckBaselines</code> in the new model version when you
      register a model with <a href="build-and-manage-steps.html#step-type-model">Model Step</a>. Once
      you approve this new model version in the model registry, the <code class="code">DriftCheckBaseline</code>
      in this model version becomes available for the <code class="code">ClarifyCheck</code> and
        <code class="code">QualityCheck</code> steps in the next pipeline process. If you want to refresh the
      baseline of a certain check type for future model versions, you can set
        <code class="code">register_new_baseline</code> to <code class="code">True</code> so that the properties with prefix
        <code class="code">BaselineUsedForDriftCheck</code> become the newly calculated baseline. In these ways,
      you can preserve your preferred baselines for a model trained in the future, or refresh the
      baselines for drift checks when needed, managing your baseline evolution and lifecycle
      throughout your model training iterations. </p>

    <p>The following diagram illustrates a model-version-centric view of the baseline evolution
      and lifecycle.</p>
    <div class="mediaobject">
       
        <img src="../../../images/sagemaker/latest/dg/images/pipelines/Baseline-Lifecycle.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
       
    </div>

  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./pipelines-selective-ex.html">Selective Execution</div><div id="next" class="next-link" accesskey="n" href="./pipeline-eventbridge.html">EventBridge Integration</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/pipelines-quality-clarify-baseline-lifecycle.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>