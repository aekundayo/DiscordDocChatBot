<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Random Cut Forest (RCF) Algorithm - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="randomcutforest" /><meta name="default_state" content="randomcutforest" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="randomcutforest.html" /><meta name="description" content="Amazon SageMaker Random Cut Forest (RCF) is an unsupervised algorithm for detecting anomalous data points within a data set. These are observations which diverge from otherwise well-structured or patterned data. Anomalies can manifest as unexpected spikes in time series data, breaks in periodicity, or unclassifiable data points. They are easy to describe in that, when viewed in a plot, they are often easily distinguishable from the &#34;regular&#34; data. Including these anomalies in a data set can drastically increase the complexity of a machine learning task since the &#34;regular&#34; data can often be described with a simple model." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="randomcutforest.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/randomcutforest.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/randomcutforest.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/randomcutforest.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/randomcutforest.html" hreflang="de" /><link rel="alternative" href="randomcutforest.html" hreflang="en-us" /><link rel="alternative" href="randomcutforest.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/randomcutforest.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/randomcutforest.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/randomcutforest.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/randomcutforest.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/randomcutforest.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/randomcutforest.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/randomcutforest.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/randomcutforest.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/randomcutforest.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/randomcutforest.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/randomcutforest.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/randomcutforest.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/randomcutforest.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/randomcutforest.html" hreflang="zh-tw" /><link rel="alternative" href="randomcutforest.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Random Cut Forest (RCF) Algorithm" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Random Cut Forest (RCF) Algorithm - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#randomcutforest" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/randomcutforest.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/randomcutforest.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/randomcutforest.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Train machine learning models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/train-model.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Choose an Algorithm",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algorithms-choose.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Use Amazon SageMaker Built-in Algorithms or Pre-trained Models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algos.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Unsupervised Built-in SageMaker Algorithms",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algorithms-unsupervised.html"
      },
      {
        "@type" : "ListItem",
        "position" : 8,
        "name" : "Random Cut Forest (RCF) Algorithm",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algorithms-unsupervised.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#randomcutforest" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="page-toc-src"><a href="randomcutforest.html#rcf-input_output">Input/Output Interface for the RCF Algorithm</a><a href="randomcutforest.html#rcf-instance-recommend">Instance Recommendations for the RCF
                Algorithm</a><a href="randomcutforest.html#rcf-sample-notebooks">Sample Notebooks</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="randomcutforest">Random Cut Forest (RCF) Algorithm</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Amazon SageMaker Random Cut Forest (RCF) is an unsupervised algorithm for detecting anomalous data
        points within a data set. These are observations which diverge from otherwise
        well-structured or patterned data. Anomalies can manifest as unexpected spikes in time
        series data, breaks in periodicity, or unclassifiable data points. They are easy to describe
        in that, when viewed in a plot, they are often easily distinguishable from the "regular"
        data. Including these anomalies in a data set can drastically increase the complexity of a
        machine learning task since the "regular" data can often be described with a simple
        model.</p><p>With each data point, RCF associates an anomaly score. Low score values indicate that the
        data point is considered "normal." High values indicate the presence of an anomaly in the
        data. The definitions of "low" and "high" depend on the application but common practice
        suggests that scores beyond three standard deviations from the mean score are considered
        anomalous.</p><p>While there are many applications of anomaly detection algorithms to one-dimensional time
        series data such as traffic volume analysis or sound volume spike detection, RCF is designed
        to work with arbitrary-dimensional input. Amazon SageMaker RCF scales well with respect to number of
        features, data set size, and number of instances.</p><div class="highlights"><h6>Topics</h6><ul><li><a href="randomcutforest.html#rcf-input_output">Input/Output Interface for the RCF Algorithm</a></li><li><a href="randomcutforest.html#rcf-instance-recommend">Instance Recommendations for the RCF
                Algorithm</a></li><li><a href="randomcutforest.html#rcf-sample-notebooks">RCF Sample Notebooks</a></li><li><a href="rcf_how-it-works.html">How RCF Works</a></li><li><a href="rcf_hyperparameters.html">RCF Hyperparameters</a></li><li><a href="random-cut-forest-tuning.html">Tune an RCF Model</a></li><li><a href="rcf-in-formats.html">RCF Response Formats</a></li></ul></div>
        <h2 id="rcf-input_output">Input/Output Interface for the RCF Algorithm</h2>

        <p>Amazon SageMaker Random Cut Forest supports the <code class="code">train</code> and <code class="code">test</code> data
            channels. The optional test channel is used to compute accuracy, precision, recall, and
            F1-score metrics on labeled data. Train and test data content types can be either
                <code class="code">application/x-recordio-protobuf</code> or <code class="code">text/csv</code> formats. For
            the test data, when using text/csv format, the content must be specified as
            text/csv;label_size=1 where the first column of each row represents the anomaly label:
            "1" for an anomalous data point and "0" for a normal data point. You can use either File
            mode or Pipe mode to train RCF models on data that is formatted as
                <code class="code">recordIO-wrapped-protobuf</code> or as <code class="code">CSV</code></p>
        <p>The train channel only supports <code class="code">S3DataDistributionType=ShardedByS3Key</code>
            and the test channel only supports <code class="code">S3DataDistributionType=FullyReplicated</code>.
            The following example specifies the S3 distribution type for the train channel using the
            <a href="https://sagemaker.readthedocs.io/en/stable/v2.html" rel="noopener noreferrer" target="_blank"><span>Amazon SageMaker Python SDK</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The <code class="code">sagemaker.inputs.s3_input</code> method was renamed to
              <code class="code">sagemaker.inputs.TrainingInput</code> in
              <a href="https://sagemaker.readthedocs.io/en/stable/v2.html#s3-input" rel="noopener noreferrer" target="_blank"><span>SageMaker Python SDK v2</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></div></div>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="py ">  import sagemaker
    
  # specify Random Cut Forest training job information and hyperparameters
  rcf = sagemaker.estimator.Estimator(...)
    
  # explicitly specify "ShardedByS3Key" distribution type
  train_data = sagemaker.inputs.TrainingInput(
       s3_data=s3_training_data_location,
       content_type='text/csv;label_size=0',
       distribution='ShardedByS3Key')
    
  # run the training job on input data stored in S3
  rcf.fit(<span>{</span>'train': train_data})</code></pre>
        
        <p>To avoid common errors around execution roles, ensure that you have the
            execution roles required, <code class="code">AmazonSageMakerFullAccess</code> and
                <code class="code">AmazonEC2ContainerRegistryFullAccess</code>. To avoid common errors around
            your image not existing or its permissions being incorrect, ensure that your ECR
            image is not larger then the allocated disk space on the training instance. To avoid
            this, run your training job on an instance that has sufficient disk space. In
            addition, if your ECR image is from a different AWS account's Elastic Container Service
            (ECS) repository, and you do not set repository permissions to grant access, this will
            result in an error. See the <a href="https://docs.aws.amazon.com/AmazonECR/latest/userguide/set-repository-policy.html">ECR repository
                permissions </a> for more information on setting a repository policy
            statement.</p>
        
        
        
        <p>See the <a href="https://docs.aws.amazon.com/sagemaker/latest/APIReference/API_S3DataSource.html"><code class="code">S3DataSource</code></a> for more information on customizing the S3 data
            source attributes. Finally, in order to take advantage of multi-instance training the
            training data must be partitioned into at least as many files as instances.</p>

        <p>For inference, RCF supports <code class="code">application/x-recordio-protobuf</code>,
                <code class="code">text/csv</code> and <code class="code">application/json</code> input data content types.
            See the <a href="sagemaker-algo-common-data-formats.html">Common Data Formats for
                    Built-in Algorithms</a> documentation for more
            information. RCF inference returns <code class="code">application/x-recordio-protobuf</code> or
                <code class="code">application/json</code> formatted output. Each record in these output data
            contains the corresponding anomaly scores for each input data point. See <a href="cdf-inference.html">Common Data
                Formats--Inference</a> for more information.</p>

        <p>For more information on input and output file formats, see <a href="rcf-in-formats.html">RCF Response Formats</a> for inference and the
                <a href="randomcutforest.html#rcf-sample-notebooks">RCF Sample Notebooks</a>.</p>
     
        <h2 id="rcf-instance-recommend">Instance Recommendations for the RCF
                Algorithm</h2>

        <p>For training, we recommend the <code class="code">ml.m4</code>, <code class="code">ml.c4</code>, and
                <code class="code">ml.c5</code> instance families. For inference we recommend using a
                <code class="code">ml.c5.xl</code> instance type in particular, for maximum performance as well
            as minimized cost per hour of usage. Although the algorithm could technically run on GPU
            instance types it does not take advantage of GPU hardware.</p>
     
        <h2 id="rcf-sample-notebooks">RCF Sample Notebooks</h2>

        <p>For an example of how to train an RCF model and perform inferences with it, see the
            <a href="https://sagemaker-examples.readthedocs.io/en/latest/introduction_to_amazon_algorithms/random_cut_forest/random_cut_forest.html" rel="noopener noreferrer" target="_blank"><span>An
            Introduction to SageMaker Random Cut Forests</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> notebook.
            For instructions how to
            create and access Jupyter notebook instances that you can use to run the example in
            SageMaker, see <a href="nbi.html">Amazon SageMaker Notebook Instances</a>. Once you have created a notebook
            instance and opened it, select the <b>SageMaker Examples</b>
            tab to see a list of all the SageMaker samples. To open a notebook, click on its <b>Use</b> tab and select <b>Create
                copy</b>.</p>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./PCA-in-formats.html">Inference Formats</div><div id="next" class="next-link" accesskey="n" href="./rcf_how-it-works.html">How It Works</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/randomcutforest.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/randomcutforest.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>