<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Step 5: Deploy the Model to Amazon EC2 - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="ex1-model-deployment" /><meta name="default_state" content="ex1-model-deployment" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="ex1-model-deployment.html" /><meta name="description" content="To get predictions, deploy your model to Amazon EC2 using Amazon SageMaker." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="ex1-model-deployment.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/ex1-model-deployment.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/ex1-model-deployment.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/ex1-model-deployment.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/ex1-model-deployment.html" hreflang="de" /><link rel="alternative" href="ex1-model-deployment.html" hreflang="en-us" /><link rel="alternative" href="ex1-model-deployment.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/ex1-model-deployment.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/ex1-model-deployment.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/ex1-model-deployment.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/ex1-model-deployment.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/ex1-model-deployment.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/ex1-model-deployment.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/ex1-model-deployment.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/ex1-model-deployment.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/ex1-model-deployment.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/ex1-model-deployment.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/ex1-model-deployment.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/ex1-model-deployment.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/ex1-model-deployment.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/ex1-model-deployment.html" hreflang="zh-tw" /><link rel="alternative" href="ex1-model-deployment.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Step 5: Deploy the Model to Amazon EC2" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Step 5: Deploy the Model to Amazon EC2 - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#ex1-model-deployment" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/ex1-model-deployment.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/ex1-model-deployment.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/ex1-model-deployment.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Use machine learning environments offered by SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/machine-learning-environments.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Amazon SageMaker Notebook Instances",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/nbi.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Use Notebook Instances to build models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/gs-console.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Step 5: Deploy the Model to Amazon EC2",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/gs-console.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#ex1-model-deployment" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="page-toc-src"><a href="ex1-model-deployment.html#ex1-deploy-model">Deploy the Model to SageMaker Hosting Services</a><a href="ex1-model-deployment.html#ex1-deploy-model-sdk-use-endpoint">(Optional) Use SageMaker Predictor to
                Reuse the Hosted Endpoint</a><a href="ex1-model-deployment.html#ex1-batch-transform">(Optional) Make Prediction with Batch
                Transform</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="ex1-model-deployment">Step 5: Deploy the Model to Amazon EC2</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>To get predictions, deploy your model to Amazon EC2 using Amazon SageMaker.</p><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="ex1-model-deployment.html#ex1-deploy-model">Deploy the Model to SageMaker Hosting Services</a></li><li><a href="ex1-model-deployment.html#ex1-deploy-model-sdk-use-endpoint">(Optional) Use SageMaker Predictor to
                Reuse the Hosted Endpoint</a></li><li><a href="ex1-model-deployment.html#ex1-batch-transform">(Optional) Make Prediction with Batch
                Transform</a></li></ul></div>
        <h2 id="ex1-deploy-model">Deploy the Model to SageMaker Hosting Services</h2>
        <p>To host a model through Amazon EC2 using Amazon SageMaker, deploy the model that you trained in
                <a href="ex1-train-model.html#ex1-train-model-sdk">Create and Run a Training Job</a> by calling
            the <code class="code">deploy</code> method of the <code class="code">xgb_model</code> estimator. When you call
            the <code class="code">deploy</code> method, you must specify the number and type of EC2 ML instances
            that you want to use for hosting an endpoint.</p>
        
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import sagemaker
from sagemaker.serializers import CSVSerializer
xgb_predictor=xgb_model.deploy(
    initial_instance_count=1,
    instance_type='ml.t2.medium',
    serializer=CSVSerializer()
)</code></pre>
            <div class="itemizedlist">
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p><code class="code">initial_instance_count</code> (int) – The number of instances
                        to deploy the model.</p>
                </li><li class="listitem">
                    <p><code class="code">instance_type</code> (str) – The type of instances that you
                        want to operate your deployed model.</p>
                </li><li class="listitem">
                    <p><code class="code">serializer</code> (int) – Serialize input data of various
                        formats (a NumPy array, list, file, or buffer) to a CSV-formatted string. We
                        use this because the XGBoost algorithm accepts input files in CSV
                        format.</p>
                </li></ul></div>
            <p>The <code class="code">deploy</code> method creates a deployable model, configures the SageMaker
            hosting services endpoint, and launches the endpoint to host the model. For more
            information, see the <a href="https://sagemaker.readthedocs.io/en/stable/estimators.html#sagemaker.estimator.Estimator.deploy" rel="noopener noreferrer" target="_blank"><span>SageMaker generic Estimator's deploy class method</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> in the <a href="https://sagemaker.readthedocs.io" rel="noopener noreferrer" target="_blank"><span>Amazon SageMaker Python SDK</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.
            To retrieve the name of endpoint that's generated by the <code class="code">deploy</code> method, run
            the following code:</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="py ">xgb_predictor.endpoint_name</code></pre>
            <p>This should return the endpoint name of the <code class="code">xgb_predictor</code>. The format
                of the endpoint name is <code class="code">"sagemaker-xgboost-YYYY-MM-DD-HH-MM-SS-SSS"</code>.
                This endpoint stays active in the ML instance, and you can make instantaneous
                predictions at any time unless you shut it down later. Copy this endpoint name and
                save it to reuse and make real-time predictions elsewhere in SageMaker Studio or SageMaker
                notebook instances.</p>
            <div class="awsdocs-note awsdocs-tip"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Tip</h6></div><div class="awsdocs-note-text"><p>To learn more about compiling and optimizing your model for deployment to
                    Amazon EC2 instances or edge devices, see <a href="neo.html">Compile and Deploy Models with
                        Neo</a>.</p></div></div>
     
        <h2 id="ex1-deploy-model-sdk-use-endpoint">(Optional) Use SageMaker Predictor to
                Reuse the Hosted Endpoint</h2>
        <p>After you deploy the model to an endpoint, you can set up a new SageMaker predictor by
            pairing the endpoint and continuously make real-time predictions in any other notebooks.
            The following example code shows how to use the SageMaker Predictor class to set up a new
            predictor object using the same endpoint. Re-use the endpoint name that you used for the
                <code class="code">xgb_predictor</code>.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="py ">import sagemaker
xgb_predictor_reuse=sagemaker.predictor.Predictor(
    endpoint_name="<code class="replaceable">sagemaker-xgboost-YYYY-MM-DD-HH-MM-SS-SSS</code>",
    sagemaker_session=sagemaker.Session(),
    serializer=sagemaker.serializers.CSVSerializer()
)</code></pre>
        <p>The <code class="code">xgb_predictor_reuse</code> Predictor behaves exactly the same as the
            original <code class="code">xgb_predictor</code>. For more information, see the <a href="https://sagemaker.readthedocs.io/en/stable/predictors.html#sagemaker.predictor.RealTimePredictor" rel="noopener noreferrer" target="_blank"><span>SageMaker Predictor</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> class in the <a href="https://sagemaker.readthedocs.io" rel="noopener noreferrer" target="_blank"><span>Amazon SageMaker Python SDK</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
     
        <h2 id="ex1-batch-transform">(Optional) Make Prediction with Batch
                Transform</h2>
        <p>Instead of hosting an endpoint in production, you can run a one-time batch inference
            job to make predictions on a test dataset using the SageMaker batch transform. After your
            model training has completed, you can extend the estimator to a <code class="code">transformer</code>
            object, which is based on the <a href="https://sagemaker.readthedocs.io/en/stable/api/inference/transformer.html" rel="noopener noreferrer" target="_blank"><span>SageMaker
                Transformer</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> class. The batch transformer reads in input data from a
            specified S3 bucket and makes predictions.</p>
        <div class="procedure"><h6>To run a batch transform job</h6><ol><li><p>Run the following code to convert the feature columns of the test dataset to a CSV
                file and uploads to the S3 bucket:</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="py ">X_test.to_csv('test.csv', index=False, header=False)

boto3.Session().resource('s3').Bucket(bucket).Object(
os.path.join(prefix, 'test/test.csv')).upload_file('test.csv')</code></pre>
                </li><li><p>Specify S3 bucket URIs of input and output for the batch transform job as shown
                    following:</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="py "># The location of the test dataset
batch_input = 's3://<span>{</span>}/<span>{</span>}/test'.format(bucket, prefix)

# The location to store the results of the batch transform job
batch_output = 's3://<span>{</span>}/<span>{</span>}/batch-prediction'.format(bucket, prefix)</code></pre>
            </li><li><p>Create a transformer object specifying the minimal number of parameters: the
                        <code class="code">instance_count</code> and <code class="code">instance_type</code> parameters to run
                    the batch transform job, and the <code class="code">output_path</code> to save prediction
                    data as shown following: </p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="py ">transformer = xgb_model.transformer(
    instance_count=1, 
    instance_type='ml.m4.xlarge', 
    output_path=batch_output
)</code></pre></li><li><p>Initiate the batch transform job by executing the <code class="code">transform()</code> method of the
                        <code class="code">transformer</code> object as shown following:</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="py ">transformer.transform(
    data=batch_input, 
    data_type='S3Prefix',
    content_type='text/csv', 
    split_type='Line'
)
transformer.wait()</code></pre></li><li><p>When the batch transform job is complete, SageMaker creates the <code class="code">test.csv.out</code>
                    prediction data saved in the <code class="code">batch_output</code> path, which should be in
                    the following format:
                        <code class="code">s3://sagemaker-&lt;region&gt;-111122223333/demo-sagemaker-xgboost-adult-income-prediction/batch-prediction</code>.
                    Run the following AWS CLI to download the output data of the batch transform
                    job:</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="py ">! aws s3 cp <span>{</span>batch_output} ./ --recursive</code></pre>
                <p>This should create the <code class="code">test.csv.out</code> file under the current
                    working directory. You'll be able to see the float values that are predicted
                    based on the logistic regression of the XGBoost training job.</p>
            </li></ol></div>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./ex1-train-model.html">Step 4: Train a Model</div><div id="next" class="next-link" accesskey="n" href="./ex1-test-model.html">Step 6: Evaluate the Model</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/ex1-model-deployment.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/ex1-model-deployment.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>