<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>RL Environments in Amazon SageMaker - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="sagemaker-rl-environments" /><meta name="default_state" content="sagemaker-rl-environments" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="sagemaker-rl-environments.html" /><meta name="description" content="Amazon SageMaker RL uses environments to mimic real-world scenarios. Given the current state of the environment and an action taken by the agent or agents, the simulator processes the impact of the action, and returns the next state and a reward. Simulators are useful in cases where it is not safe to train an agent in the real world (for example, flying a drone) or if the RL algorithm takes a long time to converge (for example, when playing chess)." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="sagemaker-rl-environments.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/sagemaker-rl-environments.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/sagemaker-rl-environments.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/sagemaker-rl-environments.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/sagemaker-rl-environments.html" hreflang="de" /><link rel="alternative" href="sagemaker-rl-environments.html" hreflang="en-us" /><link rel="alternative" href="sagemaker-rl-environments.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/sagemaker-rl-environments.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/sagemaker-rl-environments.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/sagemaker-rl-environments.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/sagemaker-rl-environments.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/sagemaker-rl-environments.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/sagemaker-rl-environments.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/sagemaker-rl-environments.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/sagemaker-rl-environments.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/sagemaker-rl-environments.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/sagemaker-rl-environments.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/sagemaker-rl-environments.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/sagemaker-rl-environments.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/sagemaker-rl-environments.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/sagemaker-rl-environments.html" hreflang="zh-tw" /><link rel="alternative" href="sagemaker-rl-environments.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="RL Environments in Amazon SageMaker" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>RL Environments in Amazon SageMaker - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#sagemaker-rl-environments" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/sagemaker-rl-environments.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/sagemaker-rl-environments.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/sagemaker-rl-environments.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Train machine learning models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/train-model.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Choose an Algorithm",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algorithms-choose.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Use Reinforcement Learning with Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/reinforcement-learning.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "RL Environments in Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/reinforcement-learning.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#sagemaker-rl-environments" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="page-toc-src"><a href="sagemaker-rl-environments.html#sagemaker-rl-environments-gym">Use OpenAI Gym Interface for Environments
                    in SageMaker RL</a><a href="sagemaker-rl-environments.html#sagemaker-rl-environments-open">Use Open-Source
                    Environments</a><a href="sagemaker-rl-environments.html#sagemaker-rl-environments-commercial">Use Commercial
                    Environments</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="sagemaker-rl-environments">RL Environments in Amazon SageMaker</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Amazon SageMaker RL uses environments to mimic real-world scenarios. Given the current state
            of the environment and an action taken by the agent or agents, the simulator processes
            the impact of the action, and returns the next state and a reward. Simulators are useful
            in cases where it is not safe to train an agent in the real world (for example, flying a
            drone) or if the RL algorithm takes a long time to converge (for example, when playing
            chess).</p><p>The following diagram shows an example of the interactions with a simulator for a car
            racing game.</p><div class="mediaobject">
             
                <img src="../../../images/sagemaker/latest/dg/images/sagemaker-rl-flow.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
             
        </div><p>The simulation environment consists of an agent and a simulator. Here, a convolutional
            neural network (CNN) consumes images from the simulator and generates actions to control
            the game controller. With multiple simulations, this environment generates training data
            of the form <code class="code">state_t</code>, <code class="code">action</code>, <code class="code">state_t+1</code>, and
                <code class="code">reward_t+1</code>. Defining the reward is not trivial and impacts the RL model
            quality. We want to provide a few examples of reward functions, but would like to make
            it user-configurable. </p><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="sagemaker-rl-environments.html#sagemaker-rl-environments-gym">Use OpenAI Gym Interface for Environments
                    in SageMaker RL</a></li><li><a href="sagemaker-rl-environments.html#sagemaker-rl-environments-open">Use Open-Source
                    Environments</a></li><li><a href="sagemaker-rl-environments.html#sagemaker-rl-environments-commercial">Use Commercial
                    Environments</a></li></ul></div>
            <h2 id="sagemaker-rl-environments-gym">Use OpenAI Gym Interface for Environments
                    in SageMaker RL</h2>
            <p>To use OpenAI Gym environments in SageMaker RL, use the following API elements. For
                more information about OpenAI Gym, see <a href="https://www.gymlibrary.dev/" rel="noopener noreferrer" target="_blank"><span>Gym Documentation</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>

            <div class="itemizedlist">
                 
                 


                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p><code class="code">env.action_space</code>—Defines the actions the agent can
                        take, specifies whether each action is continuous or discrete, and specifies
                        the minimum and maximum if the action is continuous.</p>
                </li><li class="listitem">
                    <p><code class="code">env.observation_space</code>—Defines the observations the
                        agent receives from the environment, as well as minimum and maximum for
                        continuous observations.</p>
                </li><li class="listitem">
                    <p><code class="code">env.reset()</code>—Initializes a training episode. The
                            <code class="code">reset()</code> function returns the initial state of the
                        environment, and the agent uses the initial state to take its first action.
                        The action is then sent to <code class="code">step()</code> repeatedly until the episode
                        reaches a terminal state. When <code class="code">step()</code> returns <code class="code">done =
                            True</code>, the episode ends. The RL toolkit re-initializes the
                        environment by calling <code class="code">reset()</code>.</p>
                </li><li class="listitem">
                    <p><code class="code">step()</code>—Takes the agent action as input and outputs the
                        next state of the environment, the reward, whether the episode has
                        terminated, and an <code class="code">info</code> dictionary to communicate debugging
                        information. It is the responsibility of the environment to validate the
                        inputs.</p>
                </li><li class="listitem">
                    <p><code class="code">env.render()</code>—Used for environments that have
                        visualization. The RL toolkit calls this function to capture visualizations
                        of the environment after each call to the <code class="code">step()</code>
                        function.</p>
                </li></ul></div>

         
            <h2 id="sagemaker-rl-environments-open">Use Open-Source
                    Environments</h2>
            <p>You can use open-source environments, such as EnergyPlus and RoboSchool, in SageMaker
                RL by building your own container. For more information about EnergyPlus, see <a href="https://energyplus.net/" rel="noopener noreferrer" target="_blank"><span>https://energyplus.net/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. For more
                information about RoboSchool, see <a href="https://github.com/openai/roboschool" rel="noopener noreferrer" target="_blank"><span>https://github.com/openai/roboschool</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. The HVAC and RoboSchool examples
                in the <a href="https://github.com/awslabs/amazon-sagemaker-examples/tree/master/reinforcement_learning" rel="noopener noreferrer" target="_blank"><span>SageMaker examples repository</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> show how to build a custom container to use
                with SageMaker RL:</p>
         
            <h2 id="sagemaker-rl-environments-commercial">Use Commercial
                    Environments</h2>
            <p>You can use commercial environments, such as MATLAB and Simulink, in SageMaker RL by
                building your own container. You need to manage your own licenses.</p>
        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./sagemaker-rl-workflow.html">Sample RL Workflow Using Amazon SageMaker RL</div><div id="next" class="next-link" accesskey="n" href="./sagemaker-rl-distributed.html">Distributed Training with Amazon SageMaker RL</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/sagemaker-rl-environments.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/sagemaker-rl-environments.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>