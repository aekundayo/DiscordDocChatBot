<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>How Factorization Machines Work - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="fact-machines-howitworks" /><meta name="default_state" content="fact-machines-howitworks" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="fact-machines-howitworks.html" /><meta name="description" content="The prediction task for a Factorization Machines model is to estimate a function ŷ from a feature set x i to a target domain. This domain is real-valued for regression and binary for classification. The Factorization Machines model is supervised and so has a training dataset (x" /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="fact-machines-howitworks.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/fact-machines-howitworks.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/fact-machines-howitworks.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/fact-machines-howitworks.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/fact-machines-howitworks.html" hreflang="de" /><link rel="alternative" href="fact-machines-howitworks.html" hreflang="en-us" /><link rel="alternative" href="fact-machines-howitworks.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/fact-machines-howitworks.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/fact-machines-howitworks.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/fact-machines-howitworks.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/fact-machines-howitworks.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/fact-machines-howitworks.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/fact-machines-howitworks.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/fact-machines-howitworks.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/fact-machines-howitworks.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/fact-machines-howitworks.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/fact-machines-howitworks.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/fact-machines-howitworks.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/fact-machines-howitworks.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/fact-machines-howitworks.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/fact-machines-howitworks.html" hreflang="zh-tw" /><link rel="alternative" href="fact-machines-howitworks.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="How Factorization Machines Work" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>How Factorization Machines Work - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#fact-machines-howitworks" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/fact-machines-howitworks.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/fact-machines-howitworks.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/fact-machines-howitworks.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Train machine learning models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/train-model.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Choose an Algorithm",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algorithms-choose.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Use Amazon SageMaker Built-in Algorithms or Pre-trained Models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algos.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Built-in SageMaker Algorithms for Tabular Data",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algorithms-tabular.html"
      },
      {
        "@type" : "ListItem",
        "position" : 8,
        "name" : "Factorization Machines Algorithm",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/fact-machines.html"
      },
      {
        "@type" : "ListItem",
        "position" : 9,
        "name" : "How Factorization Machines Work",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/fact-machines.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#fact-machines-howitworks" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="fact-machines-howitworks">How Factorization Machines Work</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>The prediction task for a Factorization Machines model is to estimate a function
            ŷ from a feature set x<sub>i</sub> to a target domain. This domain is
            real-valued for regression and binary for classification. The Factorization Machines
            model is supervised and so has a training dataset
                (x<sub>i</sub>,y<sub>j</sub>) available. The advantages this
            model presents lie in the way it uses a factorized parametrization to capture the
            pairwise feature interactions. It can be represented mathematically as follows: </p><div class="mediaobject">
             
                <img src="../../../images/sagemaker/latest/dg/images/FM1.jpg" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                An image containing the equation for the Factorization Machines&#xA;                    model.&#xA;            " />
             
             
        </div><p> The three terms in this equation correspond respectively to the three components of
            the model: </p><div class="itemizedlist">
             
             
             

        <ul class="itemizedlist"><li class="listitem">
                <p>The w<sub>0</sub> term represents the global bias.</p>
            </li><li class="listitem">
                <p>The w<sub>i</sub> linear terms model the strength of the
                        i<sup>th</sup> variable.</p>
            </li><li class="listitem">
                <p>The &lt;v<sub>i</sub>,v<sub>j</sub>&gt; factorization
                    terms model the pairwise interaction between the i<sup>th</sup>
                    and j<sup>th</sup> variable.</p>
            </li></ul></div><p>The global bias and linear terms are the same as in a linear model. The pairwise
            feature interactions are modeled in the third term as the inner product of the
            corresponding factors learned for each feature. Learned factors can also be considered
            as embedding vectors for each feature. For example, in a classification task, if a pair
            of features tends to co-occur more often in positive labeled samples, then the inner
            product of their factors would be large. In other words, their embedding vectors would
            be close to each other in cosine similarity. For more information about the
            Factorization Machines model, see <a href="https://www.csie.ntu.edu.tw/~b97053/paper/Rendle2010FM.pdf" rel="noopener noreferrer" target="_blank"><span>Factorization
                Machines</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p><p>For regression tasks, the model is trained by minimizing the squared error between the
            model prediction ŷ<sub>n</sub> and the target value
                y<sub>n</sub>. This is known as the square loss:</p><div class="mediaobject">
             
                <img src="../../../images/sagemaker/latest/dg/images/FM2.jpg" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                An image containing the equation for square loss.&#xA;            " />
             
             
        </div><p>For a classification task, the model is trained by minimizing the cross entropy loss,
            also known as the log loss: </p><div class="mediaobject">
             
                <img src="../../../images/sagemaker/latest/dg/images/FM3.jpg" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                An image containing the equation for log loss.&#xA;            " />
             
             
        </div><p>where: </p><div class="mediaobject">
             
                <img src="../../../images/sagemaker/latest/dg/images/FM4.jpg" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                An image containing the logistic function of the predicted values.&#xA;            " />
             
             
        </div><p>For more information about loss functions for classification, see <a href="https://en.wikipedia.org/wiki/Loss_functions_for_classification" rel="noopener noreferrer" target="_blank"><span>Loss functions
                for classification</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p><awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./fact-machines.html">Factorization Machines</div><div id="next" class="next-link" accesskey="n" href="./fact-machines-hyperparameters.html">Hyperparameters</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/fact-machines-howitworks.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/fact-machines-howitworks.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>