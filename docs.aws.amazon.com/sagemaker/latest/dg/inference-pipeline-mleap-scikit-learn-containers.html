<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Feature Processing with Spark ML and Scikit-learn - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="inference-pipeline-mleap-scikit-learn-containers" /><meta name="default_state" content="inference-pipeline-mleap-scikit-learn-containers" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="inference-pipeline-mleap-scikit-learn-containers.html" /><meta name="description" content="Build Apache Spark ML and scikit-learn containers for feature engineering in Amazon SageMaker." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="inference-pipeline-mleap-scikit-learn-containers.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" hreflang="de" /><link rel="alternative" href="inference-pipeline-mleap-scikit-learn-containers.html" hreflang="en-us" /><link rel="alternative" href="inference-pipeline-mleap-scikit-learn-containers.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" hreflang="zh-tw" /><link rel="alternative" href="inference-pipeline-mleap-scikit-learn-containers.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Feature Processing with Spark ML and Scikit-learn" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Feature Processing with Spark ML and Scikit-learn - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#inference-pipeline-mleap-scikit-learn-containers" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance,inference,deploy model,endpoint,prediction,ML application,serverless machine learning,multi model deployment,inference pipelines,ML model" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Deploy models for inference",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/deploy-model.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Real-time inference",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/realtime-endpoints.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Hosting options",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/realtime-endpoints-options.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Host models along with pre-processing logic as serial inference pipeline behind one endpoint",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/inference-pipelines.html"
      },
      {
        "@type" : "ListItem",
        "position" : 8,
        "name" : "Feature Processing with Spark ML and Scikit-learn",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/inference-pipelines.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#inference-pipeline-mleap-scikit-learn-containers" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="page-toc-src"><a href="inference-pipeline-mleap-scikit-learn-containers.html#feature-processing-spark">Feature Processing with Spark ML</a><a href="inference-pipeline-mleap-scikit-learn-containers.html#feature-processing-with-scikit">Feature Processing with
                    Scikit-Learn</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="inference-pipeline-mleap-scikit-learn-containers">Feature
                Processing with Spark ML and Scikit-learn</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Before
            training a model with either Amazon SageMaker built-in algorithms or custom algorithms, you can
            use Spark and scikit-learn preprocessors to transform your data and engineer features. </p>
            <h2 id="feature-processing-spark">Feature Processing with Spark ML</h2>
            <p>You
                can run Spark ML jobs with <a href="https://docs.aws.amazon.com/glue/latest/dg/what-is-glue.html">AWS
                    Glue</a>, a serverless ETL (extract, transform, load)
                service, from your SageMaker notebook. You can also connect to existing EMR clusters to
                run Spark ML jobs with <a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-what-is-emr.html">Amazon EMR</a>. To do
                this,
                you
                need
                an AWS Identity and Access Management (IAM) role that grants permission for making calls from your SageMaker
                notebook to AWS Glue. </p>
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>To see which Python and Spark versions AWS Glue supports, refer to <a href="https://docs.aws.amazon.com/glue/latest/dg/release-notes.html" rel="noopener noreferrer" target="_blank">AWS Glue Release
                    Notes</a>.</p></div></div>
            <p>After engineering features, you package and serialize Spark ML jobs with MLeap
                into MLeap containers that you can add to an inference pipeline. You don't need to
                use externally managed Spark clusters. With this approach, you can seamlessly scale
                from a sample of rows to terabytes of data. The same transformers work for both
                training and inference, so you don't need to duplicate preprocessing and feature
                engineering logic or develop a one-time solution to make the models persist. With
                inference pipelines, you don't need to maintain outside infrastructure, and you can
                make predictions directly from data inputs.</p>
            <p>When you run a Spark ML job on AWS Glue, a
                Spark
                ML pipeline is serialized into <a href="https://github.com/combust/mleap" rel="noopener noreferrer" target="_blank"><span>MLeap</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> format. Then, you can use
                the job with the <a href="https://github.com/aws/sagemaker-sparkml-serving-container" rel="noopener noreferrer" target="_blank"><span>SparkML Model
                    Serving Container</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> in a SageMaker Inference Pipeline. <em>MLeap</em> is a serialization format and execution engine for machine
                learning pipelines. It supports Spark, Scikit-learn, and TensorFlow for training
                pipelines and exporting them to a serialized pipeline called an MLeap Bundle. You
                can deserialize Bundles back into Spark for batch-mode scoring or into the MLeap
                runtime to power real-time API services. </p>
            <p>For an example that shows how to feature process with Spark ML, see the <a href="https://github.com/aws/amazon-sagemaker-examples/tree/main/sagemaker-python-sdk/sparkml_serving_emr_mleap_abalone" rel="noopener noreferrer" target="_blank"><span>Train an ML Model using Apache Spark in Amazon EMR and deploy in SageMaker</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>
                sample notebook.</p>
         
            <h2 id="feature-processing-with-scikit">Feature Processing with
                    Scikit-Learn</h2>
            <p>You can run and package scikit-learn jobs into containers directly in Amazon SageMaker.
                 For an example of Python code for building a scikit-learn
                featurizer model that trains on <a href="http://archive.ics.uci.edu/ml/datasets/Iris" rel="noopener noreferrer" target="_blank"><span>Fisher's Iris flower data
                    set</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> and predicts the species of Iris based on morphological
                measurements, see <a href="https://github.com/awslabs/amazon-sagemaker-examples/tree/master/sagemaker-python-sdk/scikit_learn_iris" rel="noopener noreferrer" target="_blank"><span>IRIS Training and Prediction with Sagemaker Scikit-learn</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. </p>
        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./inference-pipelines.html">Host models along with pre-processing logic as serial inference pipeline behind one endpoint</div><div id="next" class="next-link" accesskey="n" href="./inference-pipeline-create-console.html">Create a Pipeline Model </div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/inference-pipeline-mleap-scikit-learn-containers.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>