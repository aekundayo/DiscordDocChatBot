<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Tune a Factorization Machines Model - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="fm-tuning" /><meta name="default_state" content="fm-tuning" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="fm-tuning.html" /><meta name="description" content="Metrics and tunable hyperparameters for the Factorization Machines algorithm in Amazon SageMaker." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="fm-tuning.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/fm-tuning.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/fm-tuning.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/fm-tuning.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/fm-tuning.html" hreflang="de" /><link rel="alternative" href="fm-tuning.html" hreflang="en-us" /><link rel="alternative" href="fm-tuning.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/fm-tuning.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/fm-tuning.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/fm-tuning.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/fm-tuning.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/fm-tuning.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/fm-tuning.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/fm-tuning.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/fm-tuning.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/fm-tuning.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/fm-tuning.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/fm-tuning.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/fm-tuning.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/fm-tuning.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/fm-tuning.html" hreflang="zh-tw" /><link rel="alternative" href="fm-tuning.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Tune a Factorization Machines Model" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Tune a Factorization Machines Model - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#fm-tuning" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/fm-tuning.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/fm-tuning.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/fm-tuning.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Train machine learning models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/train-model.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Choose an Algorithm",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algorithms-choose.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Use Amazon SageMaker Built-in Algorithms or Pre-trained Models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algos.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Built-in SageMaker Algorithms for Tabular Data",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algorithms-tabular.html"
      },
      {
        "@type" : "ListItem",
        "position" : 8,
        "name" : "Factorization Machines Algorithm",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/fact-machines.html"
      },
      {
        "@type" : "ListItem",
        "position" : 9,
        "name" : "Tune a Factorization Machines Model",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/fact-machines.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#fm-tuning" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="page-toc-src"><a href="fm-tuning.html#fm-metrics">Metrics</a><a href="fm-tuning.html#fm-tunable-hyperparameters">Tunable Hyperparameters</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="fm-tuning">Tune a Factorization Machines Model</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p><em>Automatic model tuning</em>, also known as
            hyperparameter tuning, finds the best version of a model by running many jobs that test
            a range of hyperparameters on your dataset. You choose the tunable hyperparameters, a
            range of values for each, and an objective metric. You choose the objective metric from
            the metrics that the algorithm computes. Automatic model tuning searches the
            hyperparameters chosen to find the combination of values that result in the model that
            optimizes the objective metric.</p><p>For more information about model tuning, see <a href="automatic-model-tuning.html">Perform Automatic Model Tuning with SageMaker</a>.</p>
            <h2 id="fm-metrics">Metrics Computed by the Factorization Machines
                    Algorithm</h2>
            <p>The Factorization Machines algorithm has both binary classification and regression
                predictor types. The predictor type determines which metric you can use for
                automatic model tuning. The algorithm reports a <code class="code">test:rmse</code> regressor
                metric, which is computed during training. When tuning the model for regression
                tasks, choose this metric as the objective.</p>


            <div class="table-container"><div class="table-contents"><table id="w714aac23c11c21c31c13c21b7b5"><thead>
                        <tr>
                            <th>Metric Name</th>
                            <th>Description</th>
                            <th>Optimization Direction</th>
                        </tr>
                    </thead>

                        <tr>
                            <td tabindex="-1"><code class="code">test:rmse</code></td>
                            <td tabindex="-1"><p>Root Mean Square Error</p></td>
                            <td tabindex="-1"><p>Minimize</p></td>
                        </tr>


                    </table></div></div>

            <p>The Factorization Machines algorithm reports three binary classification metrics,
                which are computed during training. When tuning the model for binary classification
                tasks, choose one of these as the objective.</p>

            <div class="table-container"><div class="table-contents"><table id="w714aac23c11c21c31c13c21b7b9"><thead>
                        <tr>
                            <th>Metric Name</th>
                            <th>Description</th>
                            <th>Optimization Direction</th>
                        </tr>
                    </thead>

                        <tr>
                            <td tabindex="-1"><code class="code">test:binary_classification_accuracy</code></td>
                            <td tabindex="-1"><p>Accuracy</p></td>
                            <td tabindex="-1"><p>Maximize</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">test:binary_classification_cross_entropy</code></td>
                            <td tabindex="-1"><p>Cross Entropy</p></td>
                            <td tabindex="-1"><p>Minimize</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">test:binary_f_beta</code></td>
                            <td tabindex="-1"><p>Beta</p></td>
                            <td tabindex="-1"><p>Maximize</p></td>
                        </tr>

                    </table></div></div>

         
            <h2 id="fm-tunable-hyperparameters">Tunable Factorization Machines
                    Hyperparameters</h2>

            <p>You can tune the following hyperparameters for the Factorization Machines
                algorithm. The initialization parameters that contain the terms bias, linear, and
                factorization depend on their initialization method. There are three initialization
                methods: <code class="code">uniform</code>, <code class="code">normal</code>, and <code class="code">constant</code>. These
                initialization methods are not themselves tunable. The parameters that are tunable
                are dependent on this choice of the initialization method. For example, if the
                initialization method is <code class="code">uniform</code>, then only the <code class="code">scale</code>
                parameters are tunable. Specifically, if <code class="code">bias_init_method==uniform</code>,
                then <code class="code">bias_init_scale</code>, <code class="code">linear_init_scale</code>, and
                    <code class="code">factors_init_scale</code> are tunable. Similarly, if the initialization
                method is <code class="code">normal</code>, then only <code class="code">sigma</code> parameters are tunable.
                If the initialization method is <code class="code">constant</code>, then only <code class="code">value</code>
                parameters are tunable. These dependencies are listed in the following table. </p>

            <div class="table-container"><div class="table-contents"><table id="w714aac23c11c21c31c13c21b9b5"><thead>
                        <tr>
                            <th>Parameter Name</th>
                            <th>Parameter Type</th>
                            <th>Recommended Ranges</th>
                            <th>Dependency</th>
                        </tr>
                    </thead>

                        <tr>
                            <td tabindex="-1"><code class="code">bias_init_scale</code></td>
                            <td tabindex="-1"><p>ContinuousParameterRange</p></td>
                            <td tabindex="-1"><p>MinValue: 1e-8, MaxValue: 512</p></td>
                            <td tabindex="-1"><p>bias_init_method==uniform</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">bias_init_sigma</code></td>
                            <td tabindex="-1"><p>ContinuousParameterRange</p></td>
                            <td tabindex="-1"><p>MinValue: 1e-8, MaxValue: 512</p></td>
                            <td tabindex="-1"><p>bias_init_method==normal</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">bias_init_value</code></td>
                            <td tabindex="-1"><p>ContinuousParameterRange</p></td>
                            <td tabindex="-1"><p>MinValue: 1e-8, MaxValue: 512</p></td>
                            <td tabindex="-1"><p>bias_init_method==constant</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">bias_lr</code></td>
                            <td tabindex="-1"><p>ContinuousParameterRange</p></td>
                            <td tabindex="-1"><p>MinValue: 1e-8, MaxValue: 512</p></td>
                            <td tabindex="-1"><p>None</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">bias_wd</code></td>
                            <td tabindex="-1"><p>ContinuousParameterRange</p></td>
                            <td tabindex="-1"><p>MinValue: 1e-8, MaxValue: 512</p></td>
                            <td tabindex="-1"><p>None</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">epoch</code></td>
                            <td tabindex="-1"><p>IntegerParameterRange</p></td>
                            <td tabindex="-1"><p>MinValue: 1, MaxValue: 1000</p></td>
                            <td tabindex="-1"><p>None</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">factors_init_scale</code></td>
                            <td tabindex="-1"><p>ContinuousParameterRange</p></td>
                            <td tabindex="-1"><p>MinValue: 1e-8, MaxValue: 512</p></td>
                            <td tabindex="-1"><p>bias_init_method==uniform</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">factors_init_sigma</code></td>
                            <td tabindex="-1"><p>ContinuousParameterRange</p></td>
                            <td tabindex="-1"><p>MinValue: 1e-8, MaxValue: 512</p></td>
                            <td tabindex="-1"><p>bias_init_method==normal</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">factors_init_value</code></td>
                            <td tabindex="-1"><p>ContinuousParameterRange</p></td>
                            <td tabindex="-1"><p>MinValue: 1e-8, MaxValue: 512</p></td>
                            <td tabindex="-1"><p>bias_init_method==constant</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">factors_lr</code></td>
                            <td tabindex="-1"><p>ContinuousParameterRange</p></td>
                            <td tabindex="-1"><p>MinValue: 1e-8, MaxValue: 512</p></td>
                            <td tabindex="-1"><p>None</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">factors_wd</code></td>
                            <td tabindex="-1"><p>ContinuousParameterRange</p></td>
                            <td tabindex="-1"><p>MinValue: 1e-8, MaxValue: 512]</p></td>
                            <td tabindex="-1"><p>None</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">linear_init_scale</code></td>
                            <td tabindex="-1"><p>ContinuousParameterRange</p></td>
                            <td tabindex="-1"><p>MinValue: 1e-8, MaxValue: 512</p></td>
                            <td tabindex="-1"><p>bias_init_method==uniform</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">linear_init_sigma</code></td>
                            <td tabindex="-1"><p>ContinuousParameterRange</p></td>
                            <td tabindex="-1"><p>MinValue: 1e-8, MaxValue: 512</p></td>
                            <td tabindex="-1"><p>bias_init_method==normal</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">linear_init_value</code></td>
                            <td tabindex="-1"><p>ContinuousParameterRange</p></td>
                            <td tabindex="-1"><p>MinValue: 1e-8, MaxValue: 512</p></td>
                            <td tabindex="-1"><p>bias_init_method==constant</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">linear_lr</code></td>
                            <td tabindex="-1"><p>ContinuousParameterRange</p></td>
                            <td tabindex="-1"><p>MinValue: 1e-8, MaxValue: 512</p></td>
                            <td tabindex="-1"><p>None</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">linear_wd</code></td>
                            <td tabindex="-1"><p>ContinuousParameterRange</p></td>
                            <td tabindex="-1"><p>MinValue: 1e-8, MaxValue: 512</p></td>
                            <td tabindex="-1"><p>None</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">mini_batch_size</code></td>
                            <td tabindex="-1"><p>IntegerParameterRange</p></td>
                            <td tabindex="-1"><p>MinValue: 100, MaxValue: 10000</p></td>
                            <td tabindex="-1"><p>None</p></td>
                        </tr>
                    </table></div></div>


        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./fact-machines-hyperparameters.html">Hyperparameters</div><div id="next" class="next-link" accesskey="n" href="./fm-in-formats.html">Inference Formats</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/fm-tuning.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/fm-tuning.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>