<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>How the DeepAR Algorithm Works - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="deepar_how-it-works" /><meta name="default_state" content="deepar_how-it-works" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="deepar_how-it-works.html" /><meta name="description" content="During training, DeepAR accepts a training dataset and an optional test dataset. It uses the test dataset to evaluate the trained model. In general, the datasets don't have to contain the same set of time series. You can use a model trained on a given training set to generate forecasts for the future of the time series in the training set, and for other time series. Both the training and the test datasets consist of one or, preferably, more target time series. Each target time series can optionally be associated with a vector of feature time series and a vector of categorical features. For more information, see" /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="deepar_how-it-works.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/deepar_how-it-works.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/deepar_how-it-works.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/deepar_how-it-works.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/deepar_how-it-works.html" hreflang="de" /><link rel="alternative" href="deepar_how-it-works.html" hreflang="en-us" /><link rel="alternative" href="deepar_how-it-works.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/deepar_how-it-works.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/deepar_how-it-works.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/deepar_how-it-works.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/deepar_how-it-works.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/deepar_how-it-works.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/deepar_how-it-works.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/deepar_how-it-works.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/deepar_how-it-works.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/deepar_how-it-works.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/deepar_how-it-works.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/deepar_how-it-works.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/deepar_how-it-works.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/deepar_how-it-works.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/deepar_how-it-works.html" hreflang="zh-tw" /><link rel="alternative" href="deepar_how-it-works.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="How the DeepAR Algorithm Works" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>How the DeepAR Algorithm Works - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#deepar_how-it-works" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/deepar_how-it-works.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/deepar_how-it-works.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/deepar_how-it-works.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Train machine learning models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/train-model.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Choose an Algorithm",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algorithms-choose.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Use Amazon SageMaker Built-in Algorithms or Pre-trained Models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algos.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Built-in SageMaker Algorithms for Time-Series Data",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algorithms-time-series.html"
      },
      {
        "@type" : "ListItem",
        "position" : 8,
        "name" : "DeepAR Forecasting Algorithm",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/deepar.html"
      },
      {
        "@type" : "ListItem",
        "position" : 9,
        "name" : "How the DeepAR Algorithm Works",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/deepar.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#deepar_how-it-works" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="page-toc-src"><a href="deepar_how-it-works.html#deepar_under-the-hood"> How Feature Time Series Work in the DeepAR
                    Algorithm</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="deepar_how-it-works">How the DeepAR Algorithm Works</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>During training, DeepAR accepts a training dataset and an optional test dataset. It
            uses the test dataset to evaluate the trained model. In general, the datasets don't have
            to contain the same set of time series. You can use a model trained on a given training
            set to generate forecasts for the future of the time series in the training set, and for
            other time series. Both the training and the test datasets consist of one or,
            preferably, more target time series. Each target time series can optionally be
            associated with a vector of feature time series and a vector of categorical features.
            For more information, see <a href="deepar.html#deepar-inputoutput">Input/Output Interface for the DeepAR
                Algorithm</a>. </p><p>For example, the following is an element of a training set indexed by
                <em>i</em> which consists of a target time series,
                    <em>Z<sub>i,t</sub></em>, and two associated feature
            time series, <em>X<sub>i,1,t</sub></em> and
                    <em>X<sub>i,2,t</sub></em>:</p><div class="mediaobject">
             
                <img src="../../../images/sagemaker/latest/dg/images/ts-full-159.base.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                Figure 1: Target time series and associated feature time series&#xA;            " style="max-width:100%" />
             
             
        </div><p>The target time series might contain missing values, which are represented by line
            breaks in the time series.
            DeepAR
            supports only feature time series that are known in the future. This
            allows you to run "what if?" scenarios. What happens, for example, if I change the price
            of a product in some way? </p><p>Each target time series can also be associated with a number of categorical features.
            You can use these features to encode which groupings a time series belongs to.
            Categorical features allow the model to learn typical behavior for groups, which it can
            use to increase model accuracy. DeepAR implements this by learning an embedding vector
            for each group that captures the common properties of all time series in the group. </p>
            <h2 id="deepar_under-the-hood"> How Feature Time Series Work in the DeepAR
                    Algorithm</h2>
            <p>To facilitate learning time-dependent patterns, such as spikes during weekends,
                DeepAR automatically creates feature time series based on the frequency of the
                target time series. It uses these derived feature time series with the custom
                feature time series that you provide during training and inference. The following
                figure shows two of these derived time series features:
                        <em>u<sub>i,1,t</sub></em> represents the hour of
                the day and <em>u<sub>i,2,t</sub></em> the day of the
                week.</p>
            <div class="mediaobject">
                 
                    <img src="../../../images/sagemaker/latest/dg/images/ts-full-159.derived.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                    Figure 2: Derived time series&#xA;                " style="max-width:100%" />
                 
                 
            </div>
            <p>The DeepAR algorithm automatically generates these feature time series. The
                following table lists the derived features for the supported basic time
                frequencies.</p>
            <div class="table-container"><div class="table-contents"><table id="w714aac23c11c21c35b9c19c13b9"><thead>
                        <tr>
                            <th>Frequency of the Time Series</th>
                            <th>Derived Features</th>
                        </tr>
                    </thead>
                        <tr>
                            <td tabindex="-1"><code class="code">Minute</code></td>
                            <td tabindex="-1">
                                <p><code class="code">minute-of-hour</code>, <code class="code">hour-of-day</code>,
                                        <code class="code">day-of-week</code>, <code class="code">day-of-month</code>,
                                        <code class="code">day-of-year</code></p>
                            </td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">Hour</code></td>
                            <td tabindex="-1">
                                <p><code class="code">hour-of-day</code>, <code class="code">day-of-week</code>,
                                        <code class="code">day-of-month</code>, <code class="code">day-of-year</code></p>
                            </td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">Day</code></td>
                            <td tabindex="-1">
                                <p><code class="code">day-of-week</code>, <code class="code">day-of-month</code>,
                                        <code class="code">day-of-year</code></p>
                            </td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">Week</code></td>
                            <td tabindex="-1">
                                <p><code class="code">day-of-month</code>, <code class="code">week-of-year</code></p>
                            </td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><code class="code">Month</code></td>
                            <td tabindex="-1">
                                <p>month-of-year</p>
                            </td>
                        </tr>
                    </table></div></div>
            <p>DeepAR trains a model by randomly sampling several training examples from each of
                the time series in the training dataset. Each training example consists of a pair of
                adjacent context and prediction windows with fixed predefined lengths. The
                    <code class="code">context_length</code> hyperparameter controls how far in the past the
                network can see, and the <code class="code">prediction_length</code> hyperparameter controls how
                far in the future predictions can be made. During training, the algorithm ignores
                training set elements containing time series that are shorter than a specified
                prediction length. The following figure represents five samples with context lengths
                of 12 hours and prediction lengths of 6 hours drawn from element
                    <em>i</em>. For brevity, we've omitted the feature time series
                        <em>x<sub>i,1,t</sub></em> and
                        <em>u<sub>i,2,t</sub></em>.</p>
            <div class="mediaobject">
                 
                    <img src="../../../images/sagemaker/latest/dg/images/ts-full-159.sampled.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                    Figure 3: Sampled time series&#xA;                " style="max-width:100%" />
                 
                 
            </div>
            <p>To capture seasonality patterns, DeepAR also automatically feeds lagged values
                from the target time series. In the example with hourly frequency, for each time
                index, <em>t = T</em>, the model exposes the
                        <em>z<sub>i,t</sub></em> values, which occurred
                approximately one, two, and three days in the past.</p>
            <div class="mediaobject">
                 
                    <img src="../../../images/sagemaker/latest/dg/images/ts-full-159.lags.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                    Figure 4: Lagged time series&#xA;                " style="max-width:100%" />
                 
                 
            </div>
            <p>For inference, the trained model takes as input target time series, which might or
                might not have been used during training, and forecasts a probability distribution
                for the next <code class="code">prediction_length</code> values. Because DeepAR is trained on the
                entire dataset, the forecast takes into account patterns learned from similar time
                series.</p>
            <p>For information on the mathematics behind DeepAR, see <a href="https://arxiv.org/abs/1704.04110" rel="noopener noreferrer" target="_blank"><span>DeepAR: Probabilistic Forecasting with
                    Autoregressive Recurrent Networks</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. </p>
        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./deepar.html">DeepAR Forecasting</div><div id="next" class="next-link" accesskey="n" href="./deepar_hyperparameters.html">Hyperparameters</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/deepar_how-it-works.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/deepar_how-it-works.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>