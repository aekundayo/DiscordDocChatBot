<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>How Sequence-to-Sequence Works - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="seq-2-seq-howitworks" /><meta name="default_state" content="seq-2-seq-howitworks" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="seq-2-seq-howitworks.html" /><meta name="description" content="Typically, a neural network for sequence-to-sequence modeling consists of a few layers, including:" /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="seq-2-seq-howitworks.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/seq-2-seq-howitworks.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/seq-2-seq-howitworks.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/seq-2-seq-howitworks.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/seq-2-seq-howitworks.html" hreflang="de" /><link rel="alternative" href="seq-2-seq-howitworks.html" hreflang="en-us" /><link rel="alternative" href="seq-2-seq-howitworks.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/seq-2-seq-howitworks.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/seq-2-seq-howitworks.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/seq-2-seq-howitworks.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/seq-2-seq-howitworks.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/seq-2-seq-howitworks.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/seq-2-seq-howitworks.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/seq-2-seq-howitworks.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/seq-2-seq-howitworks.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/seq-2-seq-howitworks.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/seq-2-seq-howitworks.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/seq-2-seq-howitworks.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/seq-2-seq-howitworks.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/seq-2-seq-howitworks.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/seq-2-seq-howitworks.html" hreflang="zh-tw" /><link rel="alternative" href="seq-2-seq-howitworks.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="How Sequence-to-Sequence Works" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>How Sequence-to-Sequence Works - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#seq-2-seq-howitworks" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/seq-2-seq-howitworks.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/seq-2-seq-howitworks.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/seq-2-seq-howitworks.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Train machine learning models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/train-model.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Choose an Algorithm",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algorithms-choose.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Use Amazon SageMaker Built-in Algorithms or Pre-trained Models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algos.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Built-in SageMaker Algorithms for Text Data",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algorithms-text.html"
      },
      {
        "@type" : "ListItem",
        "position" : 8,
        "name" : "Sequence-to-Sequence Algorithm",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/seq-2-seq.html"
      },
      {
        "@type" : "ListItem",
        "position" : 9,
        "name" : "How Sequence-to-Sequence Works",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/seq-2-seq.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#seq-2-seq-howitworks" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="seq-2-seq-howitworks">How Sequence-to-Sequence Works</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Typically, a neural network for sequence-to-sequence modeling consists of a few
            layers, including: </p><div class="itemizedlist">
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p>An <b>embedding layer</b>. In this layer, the input
                    matrix, which is input tokens encoded in a sparse way (for example, one-hot
                    encoded) are mapped to a dense feature layer. This is required because a
                    high-dimensional feature vector is more capable of encoding information
                    regarding a particular token (word for text corpora) than a simple
                    one-hot-encoded vector. It is also a standard practice to initialize this
                    embedding layer with a pre-trained word vector like <a href="https://fasttext.cc/" rel="noopener noreferrer" target="_blank"><span>FastText</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> or <a href="https://nlp.stanford.edu/projects/glove/" rel="noopener noreferrer" target="_blank"><span>Glove</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> or to
                    initialize it randomly and learn the parameters during training. </p>
            </li><li class="listitem">
                <p>An <b>encoder layer</b>. After the input tokens are
                    mapped into a high-dimensional feature space, the sequence is passed through an
                    encoder layer to compress all the information from the input embedding layer (of
                    the entire sequence) into a fixed-length feature vector. Typically, an encoder
                    is made of RNN-type networks like long short-term memory (LSTM) or gated
                    recurrent units (GRU). (<a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/" rel="noopener noreferrer" target="_blank"><span> Colah's
                        blog</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> explains LSTM in a great detail.) </p>
            </li><li class="listitem">
                <p>A <b>decoder layer</b>. The decoder layer takes this
                    encoded feature vector and produces the output sequence of tokens. This layer is
                    also usually built with RNN architectures (LSTM and GRU). </p>
            </li></ul></div><p>The whole model is trained jointly to maximize the probability of the target sequence
            given the source sequence. This model was first introduced by <a href="https://papers.nips.cc/paper/5346-sequence-to-sequence-learning-with-neural-networks.pdf" rel="noopener noreferrer" target="_blank"><span>Sutskever et al.</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> in 2014. </p><p><b>Attention mechanism</b>. The disadvantage of an
            encoder-decoder framework is that model performance decreases as and when the length of
            the source sequence increases because of the limit of how much information the
            fixed-length encoded feature vector can contain. To tackle this problem, in 2015,
            Bahdanau et al. proposed the <a href="https://arxiv.org/pdf/1409.0473.pdf" rel="noopener noreferrer" target="_blank"><span>attention
                mechanism</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. In an attention mechanism, the decoder tries to find the location
            in the encoder sequence where the most important information could be located and uses
            that information and previously decoded words to predict the next token in the sequence. </p><p>For more in details, see the whitepaper <a href="https://arxiv.org/abs/1508.04025" rel="noopener noreferrer" target="_blank"><span>Effective Approaches to Attention-based Neural Machine Translation</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> by
            Luong, et al. that explains and simplifies calculations for various attention
            mechanisms. Additionally, the whitepaper <a href="https://arxiv.org/abs/1609.08144" rel="noopener noreferrer" target="_blank"><span>Google's Neural Machine Translation System: Bridging the Gap between Human and
                Machine Translation</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> by Wu, et al. describes Google's architecture for
            machine translation, which uses skip connections between encoder and decoder
            layers.</p><awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./seq-2-seq.html">Sequence to Sequence (seq2seq)</div><div id="next" class="next-link" accesskey="n" href="./seq-2-seq-hyperparameters.html">Hyperparameters</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/seq-2-seq-howitworks.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/seq-2-seq-howitworks.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>