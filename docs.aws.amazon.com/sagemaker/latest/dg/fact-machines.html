<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Factorization Machines Algorithm - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="fact-machines" /><meta name="default_state" content="fact-machines" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="fact-machines.html" /><meta name="description" content="The Factorization Machines algorithm is a general-purpose supervised learning algorithm that you can use for both classification and regression tasks." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="fact-machines.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/fact-machines.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/fact-machines.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/fact-machines.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/fact-machines.html" hreflang="de" /><link rel="alternative" href="fact-machines.html" hreflang="en-us" /><link rel="alternative" href="fact-machines.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/fact-machines.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/fact-machines.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/fact-machines.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/fact-machines.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/fact-machines.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/fact-machines.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/fact-machines.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/fact-machines.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/fact-machines.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/fact-machines.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/fact-machines.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/fact-machines.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/fact-machines.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/fact-machines.html" hreflang="zh-tw" /><link rel="alternative" href="fact-machines.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Factorization Machines Algorithm" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Factorization Machines Algorithm - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#fact-machines" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/fact-machines.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/fact-machines.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/fact-machines.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Train machine learning models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/train-model.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Choose an Algorithm",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algorithms-choose.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Use Amazon SageMaker Built-in Algorithms or Pre-trained Models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algos.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Built-in SageMaker Algorithms for Tabular Data",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algorithms-tabular.html"
      },
      {
        "@type" : "ListItem",
        "position" : 8,
        "name" : "Factorization Machines Algorithm",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algorithms-tabular.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#fact-machines" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="page-toc-src"><a href="fact-machines.html#fm-inputoutput">Input/Output Interface for the Factorization Machines
                Algorithm</a><a href="fact-machines.html#fm-instances">EC2 Instance Recommendation for the Factorization
                Machines Algorithm</a><a href="fact-machines.html#fm-sample-notebooks">Sample Notebooks</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="fact-machines">Factorization Machines Algorithm</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>The Factorization Machines algorithm is a general-purpose supervised learning algorithm that you can
        use for both classification and regression tasks. It is an extension of a linear model that
        is designed to capture interactions between features within high dimensional sparse datasets
        economically. For example, in a click prediction system, the Factorization Machines model can
        capture click rate patterns observed when ads from a certain ad-category are placed on pages
        from a certain page-category. Factorization machines are a good choice for tasks dealing
        with high dimensional sparse datasets, such as click prediction and item
        recommendation.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The Amazon SageMaker implementation of the Factorization Machines algorithm considers only pair-wise (2nd
            order) interactions between features.</p></div></div><div class="highlights"><h6>Topics</h6><ul><li><a href="fact-machines.html#fm-inputoutput">Input/Output Interface for the Factorization Machines
                Algorithm</a></li><li><a href="fact-machines.html#fm-instances">EC2 Instance Recommendation for the Factorization
                Machines Algorithm</a></li><li><a href="fact-machines.html#fm-sample-notebooks">Factorization Machines Sample Notebooks</a></li><li><a href="fact-machines-howitworks.html">How Factorization Machines Work</a></li><li><a href="fact-machines-hyperparameters.html">Factorization Machines
                Hyperparameters</a></li><li><a href="fm-tuning.html">Tune a Factorization Machines Model</a></li><li><a href="fm-in-formats.html">Factorization Machines Response Formats</a></li></ul></div>
        <h2 id="fm-inputoutput">Input/Output Interface for the Factorization Machines
                Algorithm</h2>


        <p>The Factorization Machines algorithm can be run in either in binary classification mode
            or regression mode. In each mode, a dataset can be provided to the <b>test</b> channel along with the train channel dataset. The scoring depends
            on the mode used. In regression mode, the testing dataset is scored using Root Mean
            Square Error (RMSE). In binary classification mode, the test dataset is scored using
            Binary Cross Entropy (Log Loss), Accuracy (at threshold=0.5) and F1 Score (at threshold
            =0.5).</p>

        <p>For <b>training</b>, the Factorization Machines algorithm
            currently supports only the <code class="code">recordIO-protobuf</code> format with
                <code class="code">Float32</code> tensors. Because their use case is predominantly on sparse
            data, <code class="code">CSV</code> is not a good candidate. Both File and Pipe mode training are
            supported for recordIO-wrapped protobuf.</p>

        <p>For <b>inference</b>, the Factorization Machines algorithm supports the
                <code class="code">application/json</code> and <code class="code">x-recordio-protobuf</code> formats. </p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p>For the <b>binary classification</b> problem, the
                    algorithm predicts a score and a label. The label is a number and can be either
                        <code class="code">0</code> or <code class="code">1</code>. The score is a number that indicates how
                    strongly the algorithm believes that the label should be <code class="code">1</code>. The
                    algorithm computes score first and then derives the label from the score value.
                    If the score is greater than or equal to 0.5, the label is
                    <code class="code">1</code>.</p>
            </li><li class="listitem">
                <p>For the <b>regression</b> problem, just a score is
                    returned and it is the predicted value. For example, if Factorization Machines
                    is used to predict a movie rating, score is the predicted rating value.</p>
            </li></ul></div>

        <p>Please see <a href="fact-machines.html#fm-sample-notebooks">Factorization Machines Sample Notebooks</a>
            for more details on training and inference file formats.</p>
     
        <h2 id="fm-instances">EC2 Instance Recommendation for the Factorization
                Machines Algorithm</h2>
        <p>The Amazon SageMaker Factorization Machines algorithm is highly scalable and can train across
            distributed instances. We recommend training and inference with CPU instances for both
            sparse and dense datasets. In some circumstances, training with one or more GPUs on
            dense data might provide some benefit. Training with GPUs is available only on dense
            data. Use CPU instances for sparse data. 
            The Factorization Machines algorithm supports P2, P3, G4dn, and G5 instances for training and inference.</p>
     
        <h2 id="fm-sample-notebooks">Factorization Machines Sample Notebooks</h2>

        <p>For a sample notebook that uses the SageMaker Factorization Machines algorithm to
            analyze the images of handwritten digits from zero to nine in the MNIST dataset, see
                <a href="https://sagemaker-examples.readthedocs.io/en/latest/introduction_to_amazon_algorithms/factorization_machines_mnist/factorization_machines_mnist.html" rel="noopener noreferrer" target="_blank"><span>An Introduction to Factorization Machines with MNIST</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. For instructions how
            to create and access Jupyter notebook instances that you can use to run the example in
            SageMaker, see <a href="nbi.html">Amazon SageMaker Notebook Instances</a>. Once you have created a notebook
            instance and opened it, select the <b>SageMaker Examples</b>
            tab to see a list of all the SageMaker samples. Example notebooks that use Factorization Machines algorithm 
            are located in the <b>Introduction to Amazon
                algorithms</b> section. To open a notebook, click on its <b>Use</b> tab and select <b>Create
                copy</b>.</p>

    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./catboost-tuning.html">Model Tuning</div><div id="next" class="next-link" accesskey="n" href="./fact-machines-howitworks.html">How It Works</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/fact-machines.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/fact-machines.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>