<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>K-Nearest Neighbors (k-NN) Algorithm - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="k-nearest-neighbors" /><meta name="default_state" content="k-nearest-neighbors" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="k-nearest-neighbors.html" /><meta name="description" content="Amazon SageMaker k-nearest neighbors (k-NN) algorithm is an index-based algorithm . It uses a non-parametric method for classification or regression. For classification problems, the algorithm queries the k points that are closest to the sample point and returns the most frequently used label of their class as the predicted label. For regression problems, the algorithm queries the" /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="k-nearest-neighbors.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/k-nearest-neighbors.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/k-nearest-neighbors.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/k-nearest-neighbors.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/k-nearest-neighbors.html" hreflang="de" /><link rel="alternative" href="k-nearest-neighbors.html" hreflang="en-us" /><link rel="alternative" href="k-nearest-neighbors.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/k-nearest-neighbors.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/k-nearest-neighbors.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/k-nearest-neighbors.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/k-nearest-neighbors.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/k-nearest-neighbors.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/k-nearest-neighbors.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/k-nearest-neighbors.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/k-nearest-neighbors.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/k-nearest-neighbors.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/k-nearest-neighbors.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/k-nearest-neighbors.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/k-nearest-neighbors.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/k-nearest-neighbors.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/k-nearest-neighbors.html" hreflang="zh-tw" /><link rel="alternative" href="k-nearest-neighbors.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="K-Nearest Neighbors (k-NN) Algorithm" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>K-Nearest Neighbors (k-NN) Algorithm - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#k-nearest-neighbors" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/k-nearest-neighbors.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/k-nearest-neighbors.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/k-nearest-neighbors.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Train machine learning models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/train-model.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Choose an Algorithm",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algorithms-choose.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Use Amazon SageMaker Built-in Algorithms or Pre-trained Models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algos.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Built-in SageMaker Algorithms for Tabular Data",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algorithms-tabular.html"
      },
      {
        "@type" : "ListItem",
        "position" : 8,
        "name" : "K-Nearest Neighbors (k-NN) Algorithm",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/algorithms-tabular.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#k-nearest-neighbors" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="page-toc-src"><a href="k-nearest-neighbors.html#kNN-input_output">Input/Output
                Interface for the k-NN Algorithm</a><a href="k-nearest-neighbors.html#kNN-sample-notebooks">Sample Notebooks</a><a href="k-nearest-neighbors.html#kNN-instances">EC2 Instance Recommendation for the k-NN Algorithm</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="k-nearest-neighbors">K-Nearest Neighbors (k-NN) Algorithm</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Amazon SageMaker k-nearest neighbors (k-NN) algorithm is an
        index-based
        algorithm. It uses a
        non-parametric
        method for classification or regression. For classification problems, the
        algorithm queries the <em>k</em> points that are closest to the sample point and
        returns the most frequently used label of their class as the predicted label. For regression
        problems, the algorithm queries the <em>k</em> closest points to the sample
        point and returns the average of their feature values as the predicted value. </p><p>Training with the k-NN algorithm has three steps: sampling, dimension reduction, and index
        building. Sampling reduces the size of the initial dataset so that it fits into memory. For
        dimension reduction, the algorithm decreases the
        feature
        dimension of the data to reduce the footprint of the k-NN model in memory
        and inference latency. We provide
        two
        methods of dimension reduction methods:
        random
        projection and the fast Johnson-Lindenstrauss transform. Typically, you
        use dimension reduction for
        high-dimensional
        (d &gt;1000) datasets to avoid the “curse of dimensionality” that troubles the statistical
        analysis of data that becomes sparse as dimensionality increases. The
        main objective of k-NN's training is to construct the index. The index enables efficient
        lookups of distances between points whose values or class labels have not yet been
        determined and the k nearest points to use for inference.</p><div class="highlights"><h6>Topics</h6><ul><li><a href="k-nearest-neighbors.html#kNN-input_output">Input/Output
                Interface for the k-NN Algorithm</a></li><li><a href="k-nearest-neighbors.html#kNN-sample-notebooks">k-NN Sample Notebooks</a></li><li><a href="kNN_how-it-works.html">How
                the k-NN Algorithm Works</a></li><li><a href="k-nearest-neighbors.html#kNN-instances">EC2 Instance Recommendation for the k-NN Algorithm</a></li><li><a href="kNN_hyperparameters.html">k-NN Hyperparameters</a></li><li><a href="kNN-tuning.html">Tune a k-NN Model</a></li><li><a href="kNN-in-formats.html">Data Formats for k-NN Training Input</a></li><li><a href="kNN-inference-formats.html">k-NN Request and Response Formats</a></li></ul></div>
        <h2 id="kNN-input_output">Input/Output
                Interface for the k-NN Algorithm</h2>
        <p>SageMaker k-NN supports train and test data channels.</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p>Use a <em>train channel</em> for data that you want to sample and
                    construct into the k-NN index.</p>
            </li><li class="listitem">
                <p>Use a <em>test channel</em> to emit scores in log files. Scores
                    are listed as one line per mini-batch: accuracy for <code class="code">classifier</code>,
                    mean-squared error (mse) for <code class="code">regressor</code> for score.</p>
            </li></ul></div>
        <p>For training inputs, k-NN supports <code class="code">text/csv</code> and
                <code class="code">application/x-recordio-protobuf</code> data formats. For input type
                <code class="code">text/csv</code>, the first <code class="code">label_size</code> columns are interpreted as
            the label vector for that row. You can use either File mode or Pipe mode to train models
            on data that is formatted as <code class="code">recordIO-wrapped-protobuf</code> or as
                <code class="code">CSV</code>.</p>
        <p>For inference inputs, k-NN supports the <code class="code">application/json</code>,
                <code class="code">application/x-recordio-protobuf</code>, and <code class="code">text/csv</code> data
            formats. The <code class="code">text/csv</code> format accepts a <code class="code">label_size</code> and encoding
            parameter. It assumes a <code class="code">label_size</code> of 0 and a UTF-8 encoding.</p>
        <p>For inference outputs, k-NN supports the <code class="code">application/json</code> and
                <code class="code">application/x-recordio-protobuf</code> data formats. These two data formats
            also support a verbose output mode. In verbose output mode, the API provides the search
            results with the distances vector sorted from smallest to largest, and corresponding
            elements in the labels vector.</p>
        <p>For batch transform, k-NN supports the <code class="code">application/jsonlines</code> data format
            for both input and output. An example input is as follows:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">content-type: application/jsonlines

<span>{</span>"features": [1.5, 16.0, 14.0, 23.0]}
<span>{</span>"data": <span>{</span>"features": <span>{</span>"values": [1.5, 16.0, 14.0, 23.0]}}</code></pre>
        <p>An example output is as follows:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">accept: application/jsonlines

<span>{</span>"predicted_label": 0.0}
<span>{</span>"predicted_label": 2.0}</code></pre>

        <p>For more information on input and output file formats, see <a href="kNN-in-formats.html">Data Formats for k-NN Training Input</a> for training, <a href="kNN-inference-formats.html">k-NN Request and Response Formats</a> for
            inference, and the <a href="k-nearest-neighbors.html#kNN-sample-notebooks">k-NN Sample Notebooks</a>.</p>
     
        <h2 id="kNN-sample-notebooks">k-NN Sample Notebooks</h2>
        <p>For a sample notebook that uses the SageMaker k-nearest neighbor algorithm to predict
            wilderness cover types from geological and forest service data, see the <a href="https://sagemaker-examples.readthedocs.io/en/latest/introduction_to_amazon_algorithms/k_nearest_neighbors_covtype/k_nearest_neighbors_covtype.html" rel="noopener noreferrer" target="_blank"><span>K-Nearest Neighbor Covertype </span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. </p>
        <p>Use a Jupyter notebook instance to run the example in SageMaker. To learn how to create and
            open a Jupyter notebook instance in SageMaker, see <a href="nbi.html">Amazon SageMaker Notebook Instances</a>.
            Once you have created a notebook instance and opened it, select the <b>SageMaker Examples</b> tab to see a list of all the SageMaker example
            notebooks. Find K-Nearest Neighbor notebooks in the  <b>Introduction
                to Amazon algorithms</b> section. To open a notebook, click on its <b>Use</b> tab and select <b>Create
                copy</b>.</p>
     
        <h2 id="kNN-instances">EC2 Instance Recommendation for the k-NN Algorithm</h2>
            <p>We recommend training on a CPU instance (such as ml.m5.2xlarge) or on a GPU instance. 
                The k-NN algorithm supports P2, P3, G4dn, and G5 GPU instance families for training and inference.</p>
            <p>Inference requests from CPUs generally have a lower average latency than requests
                from GPUs because there is a tax on CPU-to-GPU communication when you use GPU
                hardware. However, GPUs generally have higher throughput for larger batches.</p>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./fm-in-formats.html">Inference Formats</div><div id="next" class="next-link" accesskey="n" href="./kNN_how-it-works.html">How It Works</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/k-nearest-neighbors.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/k-nearest-neighbors.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>