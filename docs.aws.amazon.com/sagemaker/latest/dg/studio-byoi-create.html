<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Create a custom SageMaker image - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="studio-byoi-create" /><meta name="default_state" content="studio-byoi-create" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="studio-byoi-create.html" /><meta name="description" content="Describes how to create a custom Amazon SageMaker image using the SageMaker console." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="studio-byoi-create.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/studio-byoi-create.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/studio-byoi-create.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/studio-byoi-create.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/studio-byoi-create.html" hreflang="de" /><link rel="alternative" href="studio-byoi-create.html" hreflang="en-us" /><link rel="alternative" href="studio-byoi-create.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/studio-byoi-create.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/studio-byoi-create.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/studio-byoi-create.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/studio-byoi-create.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/studio-byoi-create.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/studio-byoi-create.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/studio-byoi-create.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/studio-byoi-create.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/studio-byoi-create.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/studio-byoi-create.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/studio-byoi-create.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/studio-byoi-create.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/studio-byoi-create.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/studio-byoi-create.html" hreflang="zh-tw" /><link rel="alternative" href="studio-byoi-create.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Create a custom SageMaker image" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Create a custom SageMaker image - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#studio-byoi-create" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/studio-byoi-create.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/studio-byoi-create.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/studio-byoi-create.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Use machine learning environments offered by SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/machine-learning-environments.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Amazon SageMaker Studio",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/studio.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Customize Amazon SageMaker Studio",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/studio-customize.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Bring your own SageMaker image",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/studio-byoi.html"
      },
      {
        "@type" : "ListItem",
        "position" : 8,
        "name" : "Create a custom SageMaker image",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/studio-byoi.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#studio-byoi-create" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="page-toc-src"><a href="studio-byoi-create.html#studio-byoi-create-console">Create a SageMaker image from the
        console</a><a href="studio-byoi-create.html#studio-byoi-sdk-create-image">Create a SageMaker image from the AWS CLI</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="studio-byoi-create">Create a custom SageMaker image</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>This topic describes how you can create a custom SageMaker image using the SageMaker console or
    AWS CLI.</p><p>When you create an image from the console, SageMaker also creates an initial image version. The
    image version represents a container image in <a href="https://console.aws.amazon.com/ecr/" rel="noopener noreferrer" target="_blank"><span>Amazon Elastic Container Registry
      (ECR)</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. The container image must satisfy the requirements to be used in Amazon SageMaker Studio.
    For more information, see <a href="studio-byoi-specs.html">Custom SageMaker image specifications</a>.
    For information on testing your image locally and resolving common issues, see the <a href="https://github.com/aws-samples/sagemaker-studio-custom-image-samples/blob/main/DEVELOPMENT.md" rel="noopener noreferrer" target="_blank"><span>SageMaker Studio Custom Image Samples repo</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p><p>After you have created your custom SageMaker image, you must attach it to your domain or shared
    space to use it with Studio. For more information, see <a href="studio-byoi-attach.html">Attach a custom SageMaker image</a>.</p>
    <h2 id="studio-byoi-create-console">Create a SageMaker image from the
        console</h2>
    <p>The following section demonstrates how to create a custom SageMaker image from the SageMaker
      console.</p>
  <div class="procedure"><h6>To create an image</h6><ol><li>
      <p>Open the Amazon SageMaker console at <a href="https://console.aws.amazon.com/sagemaker/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/sagemaker/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
    </li><li>
      <p>On the left navigation pane, choose <b>Admin configurations</b>.</p>
    </li><li>
      <p>Under <b>Admin configurations</b>, choose <b>Images</b>. </p>
    </li><li>
      <p>On the <b>Custom images</b> page, choose
        <b>Create image</b>.</p>
    </li><li>
      <p>For <b>Image source</b>, enter the registry path to the container image
        in Amazon ECR. The path is in the following format:</p>
      <p><code class="code">
        <code class="replaceable">acct-id</code>.dkr.ecr.<code class="replaceable">region</code>.amazonaws.com/<code class="replaceable">repo-name[:tag] or [@digest]</code>
      </code></p>
    </li><li>
      <p>Choose <b>Next</b>.</p>
    </li><li>
      <p>Under <b>Image properties</b>, enter the following:</p>
      <div class="itemizedlist">
         
         
         
         
         
      <ul class="itemizedlist"><li class="listitem">
          <p>Image name – The name must be unique to your account in the current AWS Region.</p>
        </li><li class="listitem">
          <p>(Optional) Display name – The name displayed in the Studio user
              interface. When not provided, <code class="code">Image name</code> is displayed.</p>
        </li><li class="listitem">
          <p>(Optional) Description – A description of the image.</p>
        </li><li class="listitem">
          <p>IAM role – The role must have the
            <a href="https://console.aws.amazon.com/iam/home?#/policies/arn:aws:iam::aws:policy/AmazonSageMakerFullAccess" rel="noopener noreferrer" target="_blank"><span>AmazonSageMakerFullAccess</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>
            policy attached. Use the dropdown menu to choose one of the following options:</p>
          <div class="itemizedlist">
             
             
             
          <ul class="itemizedlist"><li class="listitem">
              <p>Create a new role – Specify any additional Amazon Simple Storage Service (Amazon S3) buckets that you want
                users of your notebooks to have access to. If you don't want to allow access to additional
                buckets, choose <b>None</b>.</p>
              <p>SageMaker attaches the <code class="code">AmazonSageMakerFullAccess</code> policy to the role.
                The role allows users of your notebooks access to the S3 buckets listed next to
                the checkmarks.</p>
            </li><li class="listitem">
              <p>Enter a custom IAM role ARN – Enter the Amazon Resource Name (ARN) of
                your IAM role.</p>
            </li><li class="listitem">
              <p>Use existing role – Choose one of your existing roles from the list.</p>
            </li></ul></div>
        </li><li class="listitem">
          <p>(Optional) Image tags – Choose <b>Add new tag</b>. You can add
              up to 50 tags. Tags are searchable using the Studio user interface, the SageMaker
              console, or the SageMaker <code class="code">Search</code> API.</p>
        </li></ul></div>
    </li><li>
      <p>Choose <b>Submit</b>.</p>
    </li></ol></div>
  <p>The new image is displayed in the <b>Custom images</b> list and briefly
    highlighted. After the image has been successfully created, you can choose the image name to
    view its properties or choose <b>Create version</b> to create another version.</p>
  <div class="procedure"><h6>To create another image version</h6><ol><li>
      <p>Choose <b>Create version</b> on the same row as the image.</p>
    </li><li>
      <p>For <b>Image source</b>, enter the registry path to the Amazon ECR container
        image. The container image shouldn't be the same image as used in a previous version of
        the SageMaker image.</p>
    </li></ol></div>
   
    <h2 id="studio-byoi-sdk-create-image">Create a SageMaker image from the AWS CLI</h2>
    <p>You perform the following steps to create a SageMaker image from the container image using the
      AWS CLI.</p>
    <div class="itemizedlist">
       
       
       
       
    <ul class="itemizedlist"><li class="listitem"><p>Create an <code class="code">Image</code>.</p></li><li class="listitem"><p>Create an <code class="code">ImageVersion</code>.</p></li><li class="listitem"><p>Create a configuration file.</p></li><li class="listitem"><p>Create an <code class="code">AppImageConfig</code>.</p></li></ul></div>
    <div class="procedure"><h6>To create the SageMaker image entities</h6><ol><li>
        <p>Create a SageMaker image.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="cmd ">aws sagemaker create-image \
    --image-name custom-image \
    --role-arn arn:aws:iam::<code class="replaceable">&lt;acct-id&gt;</code>:role/service-role/<code class="replaceable">&lt;execution-role&gt;</code></code></pre>
        <p>The response should look similar to the following.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "ImageArn": "arn:aws:sagemaker:us-east-2:acct-id:image/custom-image"
}
</code></pre>
      </li><li>
        <p>Create a SageMaker image version from the container image.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="cmd ">aws sagemaker create-image-version \
    --image-name custom-image \
    --base-image <code class="replaceable">&lt;acct-id&gt;</code>.dkr.ecr.<code class="replaceable">&lt;region&gt;</code>.amazonaws.com/smstudio-custom:custom-image</code></pre>
        <p>The response should look similar to the following.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "ImageVersionArn": "arn:aws:sagemaker:us-east-2:acct-id:image-version/custom-image/1"
}</code></pre>
      </li><li>
        <p>Check that the image version was successfully created.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="cmd ">aws sagemaker describe-image-version \
    --image-name custom-image \
    --version-number 1</code></pre>
        <p>The response should look similar to the following.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "ImageVersionArn": "arn:aws:sagemaker:us-east-2:acct-id:image-version/custom-image/1",
    "ImageVersionStatus": "CREATED"
}</code></pre>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>If the response is <code class="code">"ImageVersionStatus": "CREATED_FAILED"</code>, the response
            also includes the failure reason. A permissions issue is a common cause of failure. You
            also can check your Amazon CloudWatch logs if you experience a failure when starting or running
            the KernelGateway app for a custom image. The name of the log group is
              <code class="code">/aws/sagemaker/studio</code>. The name of the log stream is
              <code class="code">$domainID/$userProfileName/KernelGateway/$appName</code>.</p></div></div>
      </li><li>
        <p>Create a configuration file, named <code>app-image-config-input.json</code>.
          The <code class="code">Name</code> value of <code class="code">KernelSpecs</code> must match the name of the
          kernelSpec available in the Image associated with this <code class="code">AppImageConfig</code>. This
          value is case sensitive. You can find the available kernelSpecs in an image by running
            <code class="code">jupyter-kernelspec list</code> from a shell inside the container.
            <code class="code">MountPath</code> is the path within the image to mount your Amazon Elastic File System (Amazon EFS) home
          directory. It needs to be different from the path you use inside the container because
          that path will be overridden when your Amazon EFS home directory is mounted.</p>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The following <code class="code">DefaultUID</code> and <code class="code">DefaultGID</code> combinations are
            the only accepted values: </p><div class="itemizedlist">
             
             
          <ul class="itemizedlist"><li class="listitem"><p>
              DefaultUID: 1000 and DefaultGID: 100
            </p></li><li class="listitem"><p>
              DefaultUID: 0 and DefaultGID: 0
            </p></li></ul></div></div></div>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "AppImageConfigName": "custom-image-config",
    "KernelGatewayImageConfig": <span>{</span>
        "KernelSpecs": [
            <span>{</span>
                "Name": "python3",
                "DisplayName": "Python 3 (ipykernel)"
            }
        ],
        "FileSystemConfig": <span>{</span>
            "MountPath": "/home/sagemaker-user",
            "DefaultUid": 1000,
            "DefaultGid": 100
        }
    }
}</code></pre>
      </li><li>
        <p>Create the AppImageConfig using the file created in the previous step.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="cmd ">aws sagemaker create-app-image-config \
    --cli-input-json file://app-image-config-input.json</code></pre>
        <p>The response should look similar to the following.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "AppImageConfigArn": "arn:aws:sagemaker:us-east-2:acct-id:app-image-config/custom-image-config"
}</code></pre>
      </li></ol></div>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./studio-byoi-sdk-add-container-image.html">Add a Studio-compatible
        image to ECR</div><div id="next" class="next-link" accesskey="n" href="./studio-byoi-attach.html">Attach an image</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/studio-byoi-create.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/studio-byoi-create.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>