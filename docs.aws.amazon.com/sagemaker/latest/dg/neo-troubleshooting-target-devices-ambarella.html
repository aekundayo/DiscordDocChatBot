<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Troubleshoot Ambarella Errors - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="neo-troubleshooting-target-devices-ambarella" /><meta name="default_state" content="neo-troubleshooting-target-devices-ambarella" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="neo-troubleshooting-target-devices-ambarella.html" /><meta name="description" content="SageMaker Neo requires models to be packaged in a compressed TAR file ( *.tar.gz ). Ambarella devices require additional files to be included within the compressed TAR file before it is sent for compilation. Include the following files within your compressed TAR file if you want to compile a model for Ambarella targets with SageMaker Neo:" /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="neo-troubleshooting-target-devices-ambarella.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" hreflang="de" /><link rel="alternative" href="neo-troubleshooting-target-devices-ambarella.html" hreflang="en-us" /><link rel="alternative" href="neo-troubleshooting-target-devices-ambarella.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" hreflang="zh-tw" /><link rel="alternative" href="neo-troubleshooting-target-devices-ambarella.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Troubleshoot Ambarella Errors" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Troubleshoot Ambarella Errors - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#neo-troubleshooting-target-devices-ambarella" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance,inference,deploy model,endpoint,prediction,ML application,serverless machine learning,multi model deployment,inference pipelines,ML model" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Deploy models for inference",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/deploy-model.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Optimize model performance using Neo",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/neo.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Troubleshoot Errors",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/neo-troubleshooting.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Troubleshoot Ambarella Errors",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/neo-troubleshooting.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#neo-troubleshooting-target-devices-ambarella" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="page-toc-src"><a href="neo-troubleshooting-target-devices-ambarella.html#neo-troubleshooting-target-devices-ambarella-config">Setting up the Configuration File</a><a href="neo-troubleshooting-target-devices-ambarella.html#neo-troubleshooting-target-devices-ambarella-calibration-images">Calibration Images</a><a href="neo-troubleshooting-target-devices-ambarella.html#neo-troubleshooting-target-devices-ambarella-mean-scale">Mean and Scale</a><a href="neo-troubleshooting-target-devices-ambarella.html#neo-troubleshooting-target-devices-ambarella-compilation">Check your compilation log</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="neo-troubleshooting-target-devices-ambarella">Troubleshoot
                Ambarella Errors</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>SageMaker Neo requires models to be packaged in a compressed TAR file
            (<code class="code">*.tar.gz</code>). Ambarella devices require additional files to be
            included within the compressed TAR file before it is sent for compilation. Include
            the following files within your compressed TAR file if you want to compile a model
            for Ambarella targets with SageMaker Neo:</p><div class="itemizedlist">
             
             
             
        <ul class="itemizedlist"><li class="listitem"><p>A trained model using a framework supported by SageMaker Neo </p></li><li class="listitem"><p>A JSON configuration file</p></li><li class="listitem"><p>Calibration images</p></li></ul></div><p>For example, the contents of your compressed TAR file should look similar to the following example:</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">├──amba_config.json
├──calib_data
|    ├── data1
|    ├── data2
|    ├── .
|    ├── .
|    ├── .
|    └── data500
└──mobilenet_v1_1.0_0224_frozen.pb</code></pre><p>The directory is configured as follows:</p><div class="itemizedlist">
             
             
             
        <ul class="itemizedlist"><li class="listitem"><p><code class="code">amba_config.json</code> : Configuration file</p></li><li class="listitem"><p><code class="code">calib_data</code> : Folder containing calibration images</p></li><li class="listitem"><p><code class="code">mobilenet_v1_1.0_0224_frozen.pb</code> : TensorFlow model saved as a frozen graph</p></li></ul></div><p>For information about frameworks supported by SageMaker Neo,  
            
            see <a href="neo-supported-devices-edge-frameworks.html">Supported Frameworks</a>.</p>
            <h2 id="neo-troubleshooting-target-devices-ambarella-config">Setting up the Configuration File</h2>
            <p>The configuration file provides information required by the Ambarella
                toolchain to compile the model. The configuration file must be saved as a JSON
                file and the name of the file must end with <code class="code">*config.json</code>. The
                following chart shows the contents of the configuration file.</p> 
            <div class="table-container"><div class="table-contents"><table id="w714aac25c55c21c19c17b5"><thead>
                        <tr>
                            <th>Key</th>
                            <th>Description</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                        <tr>
                            <td tabindex="-1"><p>inputs</p></td>
                            <td tabindex="-1"><p>Dictionary mapping input layers to attribute.</p></td>
                            <td tabindex="-1"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python "><span>{</span>inputs:<span>{</span>"data":<span>{</span>...},"data1":<span>{</span>...}}}</code></pre></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><p>"data"</p></td>
                            <td tabindex="-1"><p>Input layer name. Note: "data" is an example of the 
                                name you can use to label the input layer.</p></td>
                            <td tabindex="-1"><p>"data"</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><p>shape</p></td>
                            <td tabindex="-1"><p>Describes the shape of the input to the model. 
                                This follows the same conventions that SageMaker Neo uses.</p></td>
                            <td tabindex="-1"><p>"shape": "1,3,224,224"</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><p>filepath</p></td>
                            <td tabindex="-1"><p>Relative path to the directory containing calibration images. 
                                These can be binary or image files like JPG or PNG.</p></td>
                            <td tabindex="-1"><p>"filepath": "calib_data/"</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><p>colorformat</p></td>
                            <td tabindex="-1"><p>Color format that model expects. This will be used while 
                                converting images to binary. Supported values: [RGB, BGR]. Default is RGB.</p></td>
                            <td tabindex="-1"><p>"colorformat":"RGB"</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><p>mean</p></td>
                            <td tabindex="-1"><p>Mean value to be subtracted from the input. Can be a single 
                                value or a list of values. When the mean is given as a list the number of 
                                entries must match the channel dimension of the input.</p></td>
                            <td tabindex="-1"><p>"mean":128.0</p></td>
                        </tr>
                        <tr>
                            <td tabindex="-1"><p>scale</p></td>
                            <td tabindex="-1"><p>Scale value to be used for normalizing the input. Can be a 
                                single value or a list of values. When the scale is given as a list, the number of 
                                entries must match the channel dimension of the input.</p></td>
                            <td tabindex="-1"><p>"scale": 255.0</p></td>
                        </tr>
                    </table></div></div>
            <p>The following is a sample configuration file: </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python "><span>{</span>
    "inputs": <span>{</span>
        "data": <span>{</span>
                "shape": "1, 3, 224, 224",
                "filepath": "calib_data/",
                "colorformat": "RGB",
                "mean":[128,128,128],
                "scale":[128.0,128.0,128.0]
        }
    }
}</code></pre>
         
            <h2 id="neo-troubleshooting-target-devices-ambarella-calibration-images">Calibration Images</h2>
            <p>Quantize your trained model by providing calibration images. Quantizing your
                model improves the performance of the CVFlow engine on an Ambarella System
                on a Chip (SoC). The Ambarella toolchain uses the calibration images to
                determine how each layer in the model should be quantized to achieve optimal
                performance and accuracy. Each layer is quantized independently to INT8 or INT16
                formats. The final model has a mix of INT8 and INT16 layers after
                quantization.</p>
            <p><b>How many images should you use?</b></p>
            <p>It is recommended that you include between 100–200 images that are
                representative of the types of scenes the model is expected to handle. The model
                compilation time increases linearly to the number of calibration images in the
                input file.</p>
            <p><b>What are the recommended image
                formats?</b></p>
            <p>Calibration images can be in a raw binary format or image formats such as JPG
                and PNG.</p>
            <p>Your calibration folder can contain a mixture of images and binary files. If
                the calibration folder contains both images and binary files, the toolchain
                first converts the images to binary files. Once the conversion is complete, it
                uses the newly generated binary files along with the binary files that were
                originally in the folder.</p>
            <p><b>Can I convert the images into binary format first?</b></p>
            <p>Yes. You can convert the images to the binary format with open-source packages
                such as <a href="https://opencv.org/" rel="noopener noreferrer" target="_blank"><span>OpenCV</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> or <a href="https://python-pillow.org/" rel="noopener noreferrer" target="_blank"><span>PIL</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. Crop and resize the images so
                they satisfy the input layer of your trained model.</p>
            <p></p>
         
            <h2 id="neo-troubleshooting-target-devices-ambarella-mean-scale">Mean and Scale</h2>
            <p>You can specify mean and scaling pre-processing options to the Amberalla toolchain. 
                These operations are embedded into the network and are applied during inference 
                on each input. Do not provide processed data if you specify the mean or scale. More specifically, do 
                not provide data you have subtracted the mean from or have applied scaling to.</p> 
         
	    <h2 id="neo-troubleshooting-target-devices-ambarella-compilation">Check your compilation log</h2>
	    <p>For information on checking compilation log for Ambarella devices, see <a href="neo-troubleshooting-compilation.html#neo-troubleshooting-compilation-logs">Check your compilation log</a>.</p>
	<awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./neo-troubleshooting-inference.html">Troubleshoot Neo Inference Errors</div><div id="next" class="next-link" accesskey="n" href="./ei.html">Elastic Inference</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/neo-troubleshooting-target-devices-ambarella.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>