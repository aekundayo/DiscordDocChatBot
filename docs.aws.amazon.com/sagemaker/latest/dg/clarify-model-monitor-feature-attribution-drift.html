<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Monitor Feature Attribution Drift for Models in Production - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="clarify-model-monitor-feature-attribution-drift" /><meta name="default_state" content="clarify-model-monitor-feature-attribution-drift" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="clarify-model-monitor-feature-attribution-drift.html" /><meta name="description" content="Monitor feature attribution drift for models in production, using Amazon SageMaker Clarify." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="clarify-model-monitor-feature-attribution-drift.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" hreflang="de" /><link rel="alternative" href="clarify-model-monitor-feature-attribution-drift.html" hreflang="en-us" /><link rel="alternative" href="clarify-model-monitor-feature-attribution-drift.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" hreflang="zh-tw" /><link rel="alternative" href="clarify-model-monitor-feature-attribution-drift.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Monitor Feature Attribution Drift for Models in Production" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Monitor Feature Attribution Drift for Models in Production - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#clarify-model-monitor-feature-attribution-drift" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Monitor data and model quality",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/model-monitor.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Monitor Feature Attribution Drift for Models in Production",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/model-monitor.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#clarify-model-monitor-feature-attribution-drift" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="page-toc-src"><a href="clarify-model-monitor-feature-attribution-drift.html#clarify-model-monitor-sample-notebooks-feature-drift">Model Monitor
                Example Notebook</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="clarify-model-monitor-feature-attribution-drift">Monitor Feature
            Attribution Drift for Models in Production</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>A drift in the distribution of live data for models in production can result in a
        corresponding drift in the feature attribution values, just as it could cause a drift in
        bias when monitoring bias metrics. Amazon SageMaker Clarify feature attribution monitoring helps data
        scientists and ML engineers monitor predictions for feature attribution drift on a regular
        basis. As the model is monitored, customers can view exportable reports and graphs detailing
        feature attributions in SageMaker Studio and configure alerts in Amazon CloudWatch to receive
        notifications if it is detected that the attribution values drift beyond a certain
        threshold. </p><p>To illustrate this with a specific situation, consider a hypothetical scenario for college
        admissions. Assume that we observe the following (aggregated) feature attribution values in
        the training data and in the live data:</p><div class="table-container"><div class="table-contents"><table id="w714aac29c25b7"><thead><tr><th class="table-header" colspan="100"><div class="title">College Admission Hypothetical Scenario</div></th></tr>
                <tr>
                    <th>Feature</th>
                    <th>Attribution in training data</th>
                    <th>Attribution in live data</th>
                </tr>
            </thead>
                <tr>
                    <td tabindex="-1">SAT score</td>
                    <td tabindex="-1">0.70</td>
                    <td tabindex="-1">0.10</td>
                </tr>
                <tr>
                    <td tabindex="-1">GPA</td>
                    <td tabindex="-1">0.50</td>
                    <td tabindex="-1">0.20</td>
                </tr>
                <tr>
                    <td tabindex="-1">Class rank</td>
                    <td tabindex="-1">0.05</td>
                    <td tabindex="-1">0.70</td>
                </tr>
            </table></div></div><p>The change from training data to live data appears significant. The feature ranking has
        completely reversed. Similar to the bias drift, the feature attribution drifts might be
        caused by a change in the live data distribution and warrant a closer look into the model
        behavior on the live data. Again, the first step in these scenarios is to raise an alarm
        that a drift has happened.</p><p>We can detect the drift by comparing how the ranking of the individual features changed
        from training data to live data. In addition to being sensitive to changes in ranking order,
        we also want to be sensitive to the raw attribution score of the features. For instance,
        given two features that fall in the ranking by the same number of positions going from
        training to live data, we want to be more sensitive to the feature that had a higher
        attribution score in the training data. With these properties in mind, we use the Normalized
        Discounted Cumulative Gain (NDCG) score for comparing the feature attributions rankings of
        training and live data.</p><p>Specifically, assume we have the following:</p><div class="itemizedlist">
         
         
         
    <ul class="itemizedlist"><li class="listitem">
            <p><em>F=[f<sub>1</sub>​,…,f<sub>m</sub>​] </em> is the
                list of features sorted with respect to their attribution scores in the training
                data where <em>m</em> is the total number of features. For
                instance, in our case, <em>F</em>=[SAT Score, GPA, Class
                Rank].</p>
        </li><li class="listitem">
            <p><em>a(f)</em> is a function that returns the feature
                attribution score on the training data given a feature <em>f</em>. For example, <em>a</em>(SAT Score) =
                0.70.</p>
        </li><li class="listitem">
            <p><em>F′=[f′​<sub>1</sub>​, …,
                        f′​<sub>m</sub>​] </em>is the list of features sorted with
                respect to their attribution scores in the live data. For example, <em>F</em>′= [Class Rank, GPA, SAT Score].</p>
        </li></ul></div><p>Then, we can compute the NDCG as:</p><p>        NDCG=DCG/iDCG​</p><p>with </p><div class="itemizedlist">
         
         
    <ul class="itemizedlist"><li class="listitem">
            <p>DCG = ∑<sub>1</sub><sup>m</sup><em>a</em>(<em>f'<sub>i</sub></em>)/log<sub>2​</sub>(<em>i</em>+1)</p>
        </li><li class="listitem">
            <p>iDCG = ∑<sub>1</sub><sup>m</sup><em>a</em>(<em>f<sub>i</sub></em>)/log<sub>2​</sub>(<em>i</em>+1)</p>
        </li></ul></div><p>The quantity DCG measures whether features with high attribution in the training data are
        also ranked higher in the feature attribution computed on the live data. The quantity iDCG
        measures the <em>ideal score</em> and it's just a normalizing factor to ensure
        that the final quantity resides in the range [0, 1], with 1 being the best possible value. A
        NDCG value of 1 means that the feature attribution ranking in the live data is the same as
        the one in the training data. In this particular example, because the ranking changed by
        quite a bit, the NDCG value is 0.69.</p><p>In SageMaker Clarify, if the NDCG value is below 0.90, we automatically raise an alert.</p>
        <h2 id="clarify-model-monitor-sample-notebooks-feature-drift">Model Monitor
                Example Notebook</h2>

        <p>SageMaker Clarify provides the following example notebook that shows how to capture inference
            data for a real-time endpoint, create a baseline to monitor evolving bias against, and inspect the
            results: </p>
        <div class="itemizedlist">
             
        <ul class="itemizedlist"><li class="listitem">
                <p><a href="https://sagemaker-examples.readthedocs.io/en/latest/sagemaker_model_monitor/fairness_and_explainability/SageMaker-Model-Monitor-Fairness-and-Explainability.html" rel="noopener noreferrer" target="_blank"><span>Monitoring bias drift and feature attribution drift Amazon SageMaker Clarify</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>
                    – Use Amazon SageMaker Model Monitor to monitor bias drift and feature attribution drift over
                    time.</p>
            </li></ul></div>
        <p>This notebook has been verified to run in SageMaker Studio only. If you need instructions
            on how to open a notebook in SageMaker Studio, see <a href="notebooks-create-open.html">Create or Open an Amazon SageMaker Studio Notebook</a>. If you're prompted to choose a kernel,
            choose <b>Python 3 (Data Science)</b>. The following topics contain the
            highlights from the last two steps, and they contain code examples from the example
            notebook. </p>
    <div class="highlights"><h6>Topics</h6><ul><li><a href="clarify-model-monitor-shap-baseline.html">Create a SHAP Baseline for Models
                in Production</a></li><li><a href="clarify-model-monitor-model-attribution-drift-violations.html">Model Feature
                Attribution Drift Violations</a></li><li><a href="clarify-config-json-monitor-model-explainability-parameters.html">Configure
                Parameters to Monitor Attribution Drift</a></li><li><a href="clarify-model-monitor-feature-attribute-drift-schedule.html">Schedule
                Feature Attribute Drift Monitoring Jobs</a></li><li><a href="clarify-feature-attribute-drift-report.html">Inspect Reports for Feature
                Attribute Drift in Production Models</a></li><li><a href="clarify-feature-attribute-drift-cw.html">CloudWatch Metrics for Feature
                Drift Analysis</a></li></ul></div><awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./clarify-model-monitor-bias-drift-cw.html">CloudWatch Metrics for Bias Drift
                Analysis</div><div id="next" class="next-link" accesskey="n" href="./clarify-model-monitor-shap-baseline.html">Create a SHAP Baseline</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/clarify-model-monitor-feature-attribution-drift.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>