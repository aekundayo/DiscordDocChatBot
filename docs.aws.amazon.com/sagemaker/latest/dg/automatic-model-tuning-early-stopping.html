<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Stop Training Jobs Early - Amazon SageMaker</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="automatic-model-tuning-early-stopping" /><meta name="default_state" content="automatic-model-tuning-early-stopping" /><link rel="icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="../../../assets/images/favicon.ico" /><link rel="canonical" href="automatic-model-tuning-early-stopping.html" /><meta name="description" content="Learn how to stop a hyperparameter tuning job early." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon SageMaker" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Use Internet Monitor to build, train, and host machine learning models in AWS." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="automatic-model-tuning-early-stopping.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" hreflang="de" /><link rel="alternative" href="automatic-model-tuning-early-stopping.html" hreflang="en-us" /><link rel="alternative" href="automatic-model-tuning-early-stopping.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" hreflang="zh-tw" /><link rel="alternative" href="automatic-model-tuning-early-stopping.html" hreflang="x-default" /><meta name="feedback-item" content="SageMaker" /><meta name="this_doc_product" content="Amazon SageMaker" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="../../../assets/r/vendor4.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor3.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/vendor1.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-common.js@version=2021.12.02"></script><script defer="" src="../../../assets/r/awsdocs-doc-page.js@version=2021.12.02"></script><link href="../../../assets/r/vendor4.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-common.css@version=2021.12.02.css" rel="stylesheet" /><link href="../../../assets/r/awsdocs-doc-page.css@version=2021.12.02.css" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sagemaker'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Stop Training Jobs Early" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Stop Training Jobs Early - Amazon SageMaker</title><meta name="pdf" content="/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#automatic-model-tuning-early-stopping" /><meta name="rss" content="amazon-sagemaker-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=285" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html" /><meta name="keywords" content="SageMaker,Amazon SageMaker,machine learning,notebook instance,automatic model tuning,hyperparameter optimization,stopping hyperparameter job,manual stopping hyperparameter job" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Train machine learning models",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/train-model.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Perform Automatic Model Tuning with SageMaker",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/automatic-model-tuning.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Stop Training Jobs Early",
        "item" : "https://docs.aws.amazon.com/sagemaker/latest/dg/automatic-model-tuning.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="https://docs.aws.amazon.com/pdfs/sagemaker/latest/dg/sagemaker-dg.pdf#automatic-model-tuning-early-stopping" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="https://docs.aws.amazon.com/index.html">Documentation</a><a href="https://docs.aws.amazon.com/sagemaker/index.html">Amazon SageMaker</a><a href="whatis.html">Developer Guide</a></div><div id="page-toc-src"><a href="automatic-model-tuning-early-stopping.html#automatic-tuning-early-stop-how">How Early Stopping Works</a><a href="automatic-model-tuning-early-stopping.html#automatic-tuning-early-stopping-algos">Algorithms That Support Early
          Stopping</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="automatic-model-tuning-early-stopping">Stop Training Jobs Early</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Stop the training jobs that a hyperparameter tuning job launches early when they are not
      improving significantly as measured by the objective metric. Stopping training jobs early can
      help reduce compute time and helps you avoid overfitting your model. To configure a
      hyperparameter tuning job to stop training jobs early, do one of the following:</p><div class="itemizedlist">
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p>If you are using the AWS SDK for Python (Boto3), set the
            <code class="code">TrainingJobEarlyStoppingType</code> field of the <a href="https://docs.aws.amazon.com/sagemaker/latest/APIReference/API_HyperParameterTuningJobConfig.html"><code class="code">HyperParameterTuningJobConfig</code></a> object that you use to configure the
          tuning job to <code class="code">AUTO</code>.</p>
      </li><li class="listitem">
        <p>If you are using the <a href="https://sagemaker.readthedocs.io" rel="noopener noreferrer" target="_blank"><span>Amazon SageMaker Python SDK</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>, set the <code class="code">early_stopping_type</code>
          parameter of the <a href="https://sagemaker.readthedocs.io/en/stable/tuner.html" rel="noopener noreferrer" target="_blank"><span>HyperParameterTuner</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> object to <code class="code">Auto</code>.</p>
      </li><li class="listitem">
        <p>In the Amazon SageMaker console, in the <b>Create hyperparameter tuning job</b>
          workflow, under <b>Early stopping</b>, choose
          <b>Auto</b>.</p>
      </li></ul></div><p>For a sample notebook that demonstrates how to use early stopping, see <a href="https://github.com/awslabs/amazon-sagemaker-examples/blob/master/hyperparameter_tuning/image_classification_early_stopping/hpo_image_classification_early_stopping.ipynb" rel="noopener noreferrer" target="_blank"><span>https://github.com/awslabs/amazon-sagemaker-examples/blob/master/hyperparameter_tuning/image_classification_early_stopping/hpo_image_classification_early_stopping.ipynb</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>
      or open the <code class="code">hpo_image_classification_early_stopping.ipynb</code> notebook in the
        <b>Hyperparameter Tuning</b> section of the <b>SageMaker Examples</b>
      in a notebook instance. For information about using sample notebooks in a notebook instance,
      see <a href="howitworks-nbexamples.html">Example Notebooks</a>.</p>
      <h2 id="automatic-tuning-early-stop-how">How Early Stopping Works</h2>
      <p>When you enable early stopping for a hyperparameter tuning job, SageMaker evaluates each
        training job the hyperparameter tuning job launches as follows:</p>
      <div class="itemizedlist">
         
         
         
      <ul class="itemizedlist"><li class="listitem">
          <p>After each epoch of training, get the value of the objective metric.</p>
        </li><li class="listitem">
          <p>Compute the running average of the objective metric for all previous training jobs
            up to the same epoch, and then compute the median of all of the running averages.</p>
        </li><li class="listitem">
          <p>If the value of the objective metric for the current training job is worse (higher
            when minimizing or lower when maximizing the objective metric) than the median value of
            running averages of the objective metric for previous training jobs up to the same
            epoch, SageMaker stops the current training job.</p>
        </li></ul></div>
     
      <h2 id="automatic-tuning-early-stopping-algos">Algorithms That Support Early
          Stopping</h2>
      <p>To support early stopping, an algorithm must emit objective metrics for each epoch. The
        following built-in SageMaker algorithms support early stopping:</p>
      <div class="itemizedlist">
         
         
         
         
         
         
         
         
         
         
      <ul class="itemizedlist"><li class="listitem">
          <p><a href="lightgbm.html">LightGBM</a></p>
        </li><li class="listitem">
          <p><a href="catboost.html">CatBoost</a></p>
        </li><li class="listitem">
          <p><a href="autogluon-tabular.html">AutoGluon-Tabular</a></p>
        </li><li class="listitem">
          <p><a href="tabtransformer.html">TabTransformer</a></p>
        </li><li class="listitem">
          <p><a href="linear-learner.html">Linear Learner Algorithm</a>â€”Supported
            only if you use <code class="code">objective_loss</code> as the objective metric.</p>
        </li><li class="listitem">
          <p><a href="xgboost.html">XGBoost Algorithm</a></p>
        </li><li class="listitem">
          <p><a href="image-classification.html">Image Classification - MXNet</a></p>
        </li><li class="listitem">
          <p><a href="object-detection.html">Object Detection - MXNet</a></p>
        </li><li class="listitem">
          <p><a href="seq-2-seq.html">Sequence-to-Sequence Algorithm</a></p>
        </li><li class="listitem">
          <p><a href="ip-insights.html">IP Insights</a></p>
        </li></ul></div>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>This list of built-in algorithms that support early stopping is current as of December
          13, 2018. Other built-in algorithms might support early stopping in the future. If an
          algorithm emits a metric that can be used as an objective metric for a hyperparameter
          tuning job (preferably a validation metric), then it supports early stopping.</p></div></div>
      <p>To use early stopping with your own algorithm, you must write your algorithms such that
        it emits the value of the objective metric after each epoch. The following list shows how
        you can do that in different frameworks:</p>
      <div class="variablelist">
         
         
         
         
      <dl>
          <dt><span class="term">TensorFlow</span></dt>
          <dd>
            <p>Use the <code class="code">tf.keras.callbacks.ProgbarLogger</code> class. For information, see
              the <a href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/ProgbarLogger" rel="noopener noreferrer" target="_blank"><span>tf.keras.callbacks.ProgbarLogger API</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
          </dd>
         
          <dt><span class="term">MXNet</span></dt>
          <dd>
            <p>Use the <code class="code">mxnet.callback.LogValidationMetricsCallback</code>. For information,
              see the <a href="https://mxnet.apache.org/versions/master/api/python/docs/api/legacy/callback/index.html" rel="noopener noreferrer" target="_blank"><span>mxnet.callback APIs</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
          </dd>
         
          <dt><span class="term">Chainer</span></dt>
          <dd>
            <p>Extend chainer by using the <code class="code">extensions.Evaluator</code> class. For
              information, see the <a href="https://docs.chainer.org/en/v1.24.0/reference/extensions.html#evaluator" rel="noopener noreferrer" target="_blank"><span>chainer.training.extensions.Evaluator API</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
          </dd>
         
          <dt><span class="term">PyTorch and Spark</span></dt>
          <dd>
            <p>There is no high-level support. You must explicitly write your training code so
              that it computes objective metrics and writes them to logs after each epoch.</p>
          </dd>
        </dl></div>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="https://docs.aws.amazon.com/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./automatic-model-tuning-ex-cleanup.html">Clean up</div><div id="next" class="next-link" accesskey="n" href="./automatic-model-tuning-warm-start.html">Run a Warm Start Hyperparameter Tuning
        Job</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=SageMaker&amp;topic_url=https://docs.aws.amazon.com/en_us/sagemaker/latest/dg/automatic-model-tuning-early-stopping.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>